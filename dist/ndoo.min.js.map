{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/ndoo.min.js","webpack:///webpack/bootstrap b2d1c5769031e6448a59","webpack:///./_source/ts/ndoo.ts","webpack:///./_source/ts/src/ndoo.ts","webpack:///./_source/ts/src/prep.ts","webpack:///./_source/ts/src/event/api.ts","webpack:///./_source/ts/src/event/basic.ts","webpack:///./_source/ts/src/prepData.ts","webpack:///./_source/ts/src/storage.ts","webpack:///./_source/ts/src/router.ts","webpack:///./_source/ts/src/lib/index.ts","webpack:///external \"_\"","webpack:///./_source/ts/src/lib/depend.ts","webpack:///external \"jQuery\"","webpack:///external \"Zepto\"","webpack:///./_source/ts/src/lib/event.ts","webpack:///external \"Backbone\"","webpack:///./_source/ts/src/component.ts"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_10__","__WEBPACK_EXTERNAL_MODULE_12__","__WEBPACK_EXTERNAL_MODULE_13__","__WEBPACK_EXTERNAL_MODULE_15__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","ndoo_1","Ndoo","__extends","d","b","__","constructor","hasOwnProperty","prototype","Object","create","prep_1","storage_1","router_1","lib_1","prepData_1","component_1","prepData","getPrepData","_super","_lib","pageId","_pk","Date","storage","Storage","router","Router","_loader","app","block","init","appLoader","blockLoader","initLoader","doLoader","depend","callback","Do","apply","concat","seajsLoader","seajs","use","_blockData","_block","_app","_service","_exist","RegType","Component","getComponent","_rebuildEvent","event","trigger","_bindBlockEvent","removePrepData","initPageId","document","el","getElementById","getAttribute","getPk","prefix","setLoader","type","loader","toLowerCase","Error","base","ns","name","data","nsArr","replace","split","result","success","temp","arguments","length","_i","nsArr_1","ns_1","defaults","_a","nsArr_2","ns_2","has","hasApp","setApp","appName","nsmatch","match","_blockExist","set","hasBlock","setBlock","initBlock","elem","_this","blockId","_call","parse","blockName","params","pkg","each","_self","on","isFunction","blockEl","querySelector","blocks","blockEl_1","auto","level","parseInt","push","sort","block1","block2","blocks_1","item","undefined","toString","service","dispatch","filterHaldner","controller","actionName","before","after","_data","_data_1","dataItem","_filter","filter","isArray","isRun","only","_only","indexOf","except","_except","_filter_1","appData","filterPrefix","toUpperCase","run","args","slice","unshift","uniq","triggerPageStatus","onready","onload","eventHandle","extend","events","listened","Events","eventName","eventType","off","inited","_temp","TYPE_ON","TYPE_TRIGGER","_temp_1","eventTYpe","Prep","api_1","basic_1","_isDebug","EventBasic","vars","func","EventApi","e","_index","substring","eventData","window","setPrepData","ndoo_prep_data","key","value","option","destroy","DESTROY","rewrite","REWRITE","route","url","routeMatch","exec","_","event_1","jquery","zepto","$","selector","addEventListener","querySelectorAll","dataset","char","toLocaleLowerCase","setAttribute","Backbone","eventSplitter","eventsApi","iteratee","opts","names","i","context","keys","test","internalOn","obj","listening","_events","onApi","ctx","listeners","_listeners","listenTo","_listenId","uniqueId","listeningTo","_listeningTo","thisId","objId","count","options","handlers","offApi","stopListening","ids","isEmpty","remaining","j","handler","_callback","size","once","onceMap","bind","listenToOnce","map","offer","Math","max","Array","triggerApi","objEvents","cb","allEvents","all","triggerEvents","ev","l","a1","a2","a3","unbind","ndoo","path","isStatic","component","instance","method","App","Block","Service"],"mappings":"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","file":"./dist/ndoo.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"jQuery\", \"Zepto\", \"Backbone\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ndoo\"] = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse\n\t\troot[\"ndoo\"] = factory(root[\"_\"], root[\"jQuery\"], root[\"Zepto\"], root[\"Backbone\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_10__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_15__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"jQuery\", \"Zepto\", \"Backbone\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ndoo\"] = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse\n\t\troot[\"ndoo\"] = factory(root[\"_\"], root[\"jQuery\"], root[\"Zepto\"], root[\"Backbone\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_10__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_15__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar ndoo_1 = __webpack_require__(2);\n\tmodule.exports = new ndoo_1.Ndoo();\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar prep_1 = __webpack_require__(3);\n\tvar storage_1 = __webpack_require__(7);\n\tvar router_1 = __webpack_require__(8);\n\tvar lib_1 = __webpack_require__(9);\n\tvar prepData_1 = __webpack_require__(6);\n\tvar component_1 = __webpack_require__(16);\n\tvar prepData = prepData_1.getPrepData();\n\tvar Ndoo = (function (_super) {\n\t    __extends(Ndoo, _super);\n\t    function Ndoo() {\n\t        _super.call(this);\n\t        this._lib = lib_1._lib;\n\t        this.pageId = '';\n\t        this._pk = +new Date();\n\t        this.storage = storage_1.Storage;\n\t        this.router = router_1.Router;\n\t        this._loader = {\n\t            app: 'do',\n\t            block: 'do',\n\t            init: 'do',\n\t            appLoader: null,\n\t            blockLoader: null,\n\t            initLoader: null,\n\t            doLoader: function (depend, callback) {\n\t                Do.apply(null, depend.concat(callback));\n\t            },\n\t            seajsLoader: function (depend, callback) {\n\t                seajs.use(depend, callback);\n\t            }\n\t        };\n\t        this._blockData = {\n\t            _block: {},\n\t            _app: {},\n\t            _service: {},\n\t            _exist: {}\n\t        };\n\t        this.RegType = component_1.RegType;\n\t        this.Component = component_1.getComponent(this);\n\t        this.storage._lib = this._lib;\n\t        this._rebuildEvent();\n\t        this.event.init();\n\t        this.trigger('STATUS:NAPP_DEFINE');\n\t        this.trigger('STATUS:NBLOCK_DEFINE');\n\t        this.trigger('STATUS:NSERVICE_DEFINE');\n\t        this._bindBlockEvent();\n\t        if (prepData) {\n\t            prepData_1.removePrepData();\n\t        }\n\t    }\n\t    Ndoo.prototype.initPageId = function (id) {\n\t        if (this.pageId) {\n\t            return;\n\t        }\n\t        if (typeof document != 'undefined') {\n\t            var el = document.getElementById(id || 'scriptArea');\n\t            if (el) {\n\t                this.pageId = el.getAttribute('data-page-id') || '';\n\t            }\n\t            if (!this.pageId && id) {\n\t                this.pageId = id;\n\t            }\n\t        }\n\t    };\n\t    Ndoo.prototype.getPk = function (prefix) {\n\t        if (prefix === void 0) { prefix = ''; }\n\t        return \"\" + prefix + ++this._pk;\n\t    };\n\t    Ndoo.prototype.setLoader = function (type, loader) {\n\t        this._loader[type] = type + \"Loader\";\n\t        this._loader[(type + \"Loader\")] = loader;\n\t    };\n\t    Ndoo.prototype.require = function (depend, callback, type) {\n\t        type = type.toLowerCase();\n\t        if (this._loader[(type + \"Loader\")]) {\n\t            this[type](depend, callback);\n\t        }\n\t        else {\n\t            throw new Error('require load is not define');\n\t        }\n\t    };\n\t    Ndoo.prototype._block = function (base, ns, name, block) {\n\t        var data;\n\t        var nsArr;\n\t        if (base == 'block' || base == 'app' || base == 'service') {\n\t            data = this._blockData[(\"_\" + base)];\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t        if (ns) {\n\t            nsArr = ns.replace(/^[/.]|[/.]$/g, '').split(/[/.]/);\n\t        }\n\t        else {\n\t            nsArr = [];\n\t        }\n\t        var temp = data;\n\t        var result;\n\t        var success;\n\t        if (block || arguments.length > 3) {\n\t            for (var _i = 0, nsArr_1 = nsArr; _i < nsArr_1.length; _i++) {\n\t                var ns_1 = nsArr_1[_i];\n\t                temp = temp[ns_1] || (temp[ns_1] = {});\n\t            }\n\t            if (block && (base === 'app' || base === 'block')) {\n\t                if (typeof block === 'object') {\n\t                    if (base === 'app' && temp[name]) {\n\t                        result = this._lib.defaults(temp[name], block);\n\t                    }\n\t                    else {\n\t                        result = temp[name] = block;\n\t                    }\n\t                }\n\t                else if (typeof block === 'function') {\n\t                    result = temp[name] = block;\n\t                }\n\t                else {\n\t                    result = false;\n\t                }\n\t            }\n\t            else if (base == 'service') {\n\t                result = temp[name] = block;\n\t                success = true;\n\t            }\n\t            else {\n\t                result = false;\n\t            }\n\t            if (result || success) {\n\t                if (ns) {\n\t                    this._blockData._exist[(base + \".\" + ns + \".\" + name)] = true;\n\t                }\n\t                else {\n\t                    this._blockData._exist[(base + \".\" + name)] = true;\n\t                }\n\t            }\n\t            return result;\n\t        }\n\t        else {\n\t            for (var _a = 0, nsArr_2 = nsArr; _a < nsArr_2.length; _a++) {\n\t                var ns_2 = nsArr_2[_a];\n\t                if (!this._lib.has(temp, ns_2)) {\n\t                    return undefined;\n\t                }\n\t                temp = temp[ns_2];\n\t            }\n\t            return temp[name];\n\t        }\n\t    };\n\t    Ndoo.prototype.hasApp = function (ns) {\n\t        return this._blockData._exist[(\"app.\" + ns)];\n\t    };\n\t    Ndoo.prototype.setApp = function (ns) {\n\t        return this._blockData._exist[(\"app.\" + ns)] = true;\n\t    };\n\t    Ndoo.prototype.app = function (ns, app) {\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var appName;\n\t        if (!nsmatch) {\n\t            nsmatch = [, null, ns];\n\t        }\n\t        ns = nsmatch[1], appName = nsmatch[2];\n\t        if (arguments.length > 1) {\n\t            return this._block('app', ns, appName, app);\n\t        }\n\t        else {\n\t            return this._block('app', ns, appName);\n\t        }\n\t    };\n\t    Ndoo.prototype._blockExist = function (ns, set) {\n\t        if (set === void 0) { set = false; }\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var name;\n\t        if (!nsmatch) {\n\t            nsmatch = [, '_default', ns];\n\t        }\n\t        ns = nsmatch[1], name = nsmatch[2];\n\t        if (set) {\n\t            return this._blockData._exist[(\"block.\" + ns + \".\" + name)] = true;\n\t        }\n\t        else {\n\t            return this._blockData._exist[(\"block.\" + ns + \".\" + name)];\n\t        }\n\t    };\n\t    Ndoo.prototype.hasBlock = function (ns) {\n\t        return this._blockExist(ns);\n\t    };\n\t    Ndoo.prototype.setBlock = function (ns) {\n\t        return this._blockExist(ns, true);\n\t    };\n\t    Ndoo.prototype.block = function (ns, block) {\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var name;\n\t        if (!nsmatch) {\n\t            nsmatch = [, 'default', ns];\n\t        }\n\t        ns = nsmatch[0], name = nsmatch[1];\n\t        if (arguments.length > 1) {\n\t            return this._block('block', ns, name, block);\n\t        }\n\t        else {\n\t            return this._block('block', ns, name);\n\t        }\n\t    };\n\t    Ndoo.prototype.initBlock = function (elem) {\n\t        var _this = this;\n\t        var _a = this, _lib = _a._lib, router = _a.router;\n\t        var blockId = _lib.data(elem, 'nblockId');\n\t        blockId = blockId.split(/\\s*,\\s*|\\s+/);\n\t        var _call = function (blockId) {\n\t            router.parse(/^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/, blockId, function (ns, blockName, params) {\n\t                ns = ns.replace(/\\//g, '.');\n\t                var pkg = ns + \".\" + blockName;\n\t                if (_this.block(pkg)) {\n\t                    _this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n\t                }\n\t                else if (_this.hasBlock(pkg)) {\n\t                    _this.require([(ns + \".\" + blockName)], function () {\n\t                        _this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n\t                    }, _this._loader['block']);\n\t                }\n\t            });\n\t        };\n\t        _lib.each(blockId, function (id) {\n\t            var _self = _this;\n\t            _call.call(_self, id);\n\t        });\n\t    };\n\t    Ndoo.prototype._bindBlockEvent = function () {\n\t        var _this = this;\n\t        this.on('NBLOCK_LOADED', function (elem, ns, name, params) {\n\t            ns == null && (ns = '_default');\n\t            var block = _this.block(ns + \".\" + name);\n\t            if (block) {\n\t                if (_this._lib.isFunction(block.init)) {\n\t                    var call = function () {\n\t                        block.init(elem, params);\n\t                    };\n\t                    if (block.depend) {\n\t                        _this.require([].concat(block.depend), call, _this._loader['block']);\n\t                    }\n\t                    else {\n\t                        call();\n\t                    }\n\t                }\n\t                else if (_this._lib.isFunction(block)) {\n\t                    block(elem, params);\n\t                }\n\t            }\n\t        });\n\t        this.on('NBLOCK_INIT', function () {\n\t            var blockEl = _this._lib.querySelector('[data-nblock-id]');\n\t            if (!blockEl || !blockEl.length) {\n\t                return;\n\t            }\n\t            var blocks = [];\n\t            for (var _i = 0, blockEl_1 = blockEl; _i < blockEl_1.length; _i++) {\n\t                var el = blockEl_1[_i];\n\t                var auto = _this._lib.data(el, 'nblockAuto');\n\t                var level = parseInt(_this._lib.data(el, 'nblockLevel')) || 5;\n\t                blocks.push([level, auto, el]);\n\t            }\n\t            blocks = blocks.sort(function (block1, block2) { return block1[0] - block2[0]; });\n\t            for (var _a = 0, blocks_1 = blocks; _a < blocks_1.length; _a++) {\n\t                var item = blocks_1[_a];\n\t                var auto = item[1], block = item[2];\n\t                if (auto === undefined || auto.toString() != 'false') {\n\t                    _this.initBlock(block);\n\t                }\n\t            }\n\t        });\n\t    };\n\t    Ndoo.prototype.service = function (ns, service) {\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var name;\n\t        if (!nsmatch) {\n\t            nsmatch = [, '_default', ns];\n\t        }\n\t        ns = nsmatch[1], name = nsmatch[2];\n\t        if (arguments.length > 1) {\n\t            return this._block('service', ns, name, service);\n\t        }\n\t        else {\n\t            service = this._block('service', ns, name);\n\t            if (service && this._lib.isFunction(service.init)) {\n\t                return service.init();\n\t            }\n\t            else {\n\t                return service;\n\t            }\n\t        }\n\t    };\n\t    Ndoo.prototype.dispatch = function () {\n\t        var _this = this;\n\t        var _lib = this._lib;\n\t        var filterHaldner = function (type, controller, actionName, params) {\n\t            var data;\n\t            var _lib = _this._lib;\n\t            if (type === 'before') {\n\t                data = controller.before;\n\t            }\n\t            else if (type === 'after') {\n\t                data = controller.after;\n\t            }\n\t            if (!data) {\n\t                return;\n\t            }\n\t            var _data;\n\t            if (typeof data === 'object') {\n\t                _data = [].concat(data);\n\t            }\n\t            for (var _i = 0, _data_1 = _data; _i < _data_1.length; _i++) {\n\t                var dataItem = _data_1[_i];\n\t                var _filter = dataItem.filter;\n\t                if (!_lib.isArray(_filter)) {\n\t                    _filter = [].concat(_filter.split(/\\s*,\\s*|\\s+/));\n\t                }\n\t                var isRun = true;\n\t                if (dataItem.only) {\n\t                    var _only = dataItem.only;\n\t                    if (!_lib.isArray(_only)) {\n\t                        _only = [].concat(_only.split(/\\s*,\\s*|\\s+/));\n\t                    }\n\t                    if (_lib.indexOf(_only, actionName) < 0) {\n\t                        isRun = false;\n\t                    }\n\t                }\n\t                else if (dataItem.except) {\n\t                    var _except = dataItem.except;\n\t                    if (!_lib.isArray(_except)) {\n\t                        _except = [].concat(_except.split(/\\s*,\\s*|\\s+/));\n\t                    }\n\t                    if (_lib.indexOf(_except, actionName) > -1) {\n\t                        isRun = false;\n\t                    }\n\t                }\n\t                if (isRun) {\n\t                    for (var _a = 0, _filter_1 = _filter; _a < _filter_1.length; _a++) {\n\t                        var filter = _filter_1[_a];\n\t                        controller[(filter + \"Filter\")](actionName, params);\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        this.on('NAPP_ACTION_BEFORE', function () {\n\t            var data = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                data[_i - 0] = arguments[_i];\n\t            }\n\t            return filterHaldner.apply(null, ['before'].concat(data));\n\t        });\n\t        this.on('NAPP_ACTION_AFTER', function () {\n\t            var data = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                data[_i - 0] = arguments[_i];\n\t            }\n\t            return filterHaldner.apply(null, ['after'].concat(data));\n\t        });\n\t        this.on('NAPP_LOADED', function (ns, appName, actionName, params) {\n\t            var appData;\n\t            var _self = _this;\n\t            if (ns) {\n\t                appData = _this.app(ns + \".\" + appName);\n\t            }\n\t            else {\n\t                appData = _this.app(appName);\n\t            }\n\t            if (!_lib.has(appData, actionName + \"Action\")\n\t                && _lib.has(appData, 'emptyAction')) {\n\t                actionName = '_empty';\n\t            }\n\t            var depend = [];\n\t            if (appData['depend']) {\n\t                depend = depend.concat(appData['depend']);\n\t            }\n\t            if (appData[(actionName + \"Depend\")]) {\n\t                depend = depend.concat(appData[(actionName + \"Depend\")]);\n\t            }\n\t            var filterPrefix = appName;\n\t            if (ns) {\n\t                filterPrefix = (ns + \".\" + appName).replace(/\\./g, '_');\n\t            }\n\t            filterPrefix = filterPrefix.toUpperCase();\n\t            var run = function () {\n\t                var args = [].slice.call(arguments, 0);\n\t                args.unshift(params);\n\t                if (actionName) {\n\t                    _self.trigger('NAPP_ACTION_BEFORE', appData, actionName, params);\n\t                    _self.trigger(\"NAPP_\" + filterPrefix + \"_ACTION_BEFORE\", appData, actionName, params);\n\t                    if (appData[(actionName + \"Before\")]) {\n\t                        appData[(actionName + \"Before\")].apply(appData, args);\n\t                    }\n\t                    if (appData[(actionName + \"Action\")]) {\n\t                        appData[(actionName + \"Action\")].apply(appData, args);\n\t                    }\n\t                    if (appData[(actionName + \"After\")]) {\n\t                        appData[(actionName + \"After\")].apply(appData, args);\n\t                    }\n\t                    _self.trigger(\"NAPP_\" + filterPrefix + \"_ACTION_AFTER\", appData, actionName, params);\n\t                    _self.trigger('NAPP_ACTION_AFTER', appData, actionName, params);\n\t                }\n\t                _self.trigger('STATUS:NBLOCK_INIT');\n\t            };\n\t            if (depend.length) {\n\t                _this.require(_lib.uniq(depend), run, _this._loader['app']);\n\t            }\n\t            else {\n\t                run();\n\t            }\n\t        });\n\t        this.on('PAGE_STATUS_ROUTING', function (data) {\n\t            _this.router.parse(/^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/, data, function (appName, actionName, params) {\n\t                var nsmatch = appName.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t                var ns = '';\n\t                if (nsmatch) {\n\t                    ns = nsmatch[1], appName = nsmatch[2];\n\t                }\n\t                var pkg;\n\t                if (ns) {\n\t                    ns = ns.replace(/\\//g, '.');\n\t                    pkg = ns + \".\" + appName;\n\t                }\n\t                else {\n\t                    pkg = appName;\n\t                }\n\t                if (_this.app(pkg)) {\n\t                    _this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n\t                }\n\t                else if (_this.hasApp(pkg)) {\n\t                    _this.require([pkg], function () {\n\t                        this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n\t                    }, _this._loader['app']);\n\t                }\n\t                else {\n\t                    _this.trigger('STATUS:NBLOCK_INIT');\n\t                }\n\t            });\n\t        });\n\t    };\n\t    Ndoo.prototype.triggerPageStatus = function (depend) {\n\t        var _this = this;\n\t        var _lib = this._lib;\n\t        var call = function () {\n\t            _this.trigger('STATUS:PAGE_STATUS_FAST');\n\t            _lib.onready(function () {\n\t                _this.trigger('STATUS:PAGE_STATUS_DOMPREP');\n\t                _this.trigger('STATUS:PAGE_STATUS_DOM');\n\t                _this.trigger('STATUS:PAGE_STATUS_DOMORLOAD');\n\t            });\n\t            _lib.onload(function () {\n\t                _this.trigger('STATUS:PAGE_STATUS_LOAD');\n\t            });\n\t            _this.on('PAGE_STATUS_DOM', function () {\n\t                if (_this.pageId) {\n\t                    _this.trigger('STATUS:PAGE_STATUS_ROUTING', _this.pageId);\n\t                }\n\t            });\n\t        };\n\t        depend ? this.require([].concat(depend), call, this._loader['init']) : call();\n\t    };\n\t    Ndoo.prototype.init = function (id, depend) {\n\t        var _lib = this._lib;\n\t        if (_lib.isArray(id)) {\n\t            _a = ['', id], id = _a[0], depend = _a[1];\n\t        }\n\t        this.initPageId(id);\n\t        this.dispatch();\n\t        this.triggerPageStatus(depend);\n\t        return this;\n\t        var _a;\n\t    };\n\t    Ndoo.prototype._rebuildEvent = function () {\n\t        var _lib = this._lib;\n\t        var eventHandle = _lib.extend({\n\t            events: {},\n\t            listened: {}\n\t        }, _lib.Events);\n\t        this.event = _lib.extend(this.event, {\n\t            eventHandle: eventHandle,\n\t            on: function (eventName, callback) {\n\t                var eventHandle = this.eventHandle;\n\t                eventHandle.on(eventName, callback);\n\t                eventHandle.listened[eventName] = true;\n\t                if (_lib.has(eventHandle.events, \"STATUS:\" + eventName)) {\n\t                    callback.apply(eventHandle, eventHandle.events[(\"STATUS:\" + eventName)]);\n\t                }\n\t                if (_lib.has(eventHandle.events, eventName)) {\n\t                    for (var _i = 0, _a = eventHandle.events[eventName]; _i < _a.length; _i++) {\n\t                        var item = _a[_i];\n\t                        callback.apply(eventHandle, item);\n\t                    }\n\t                }\n\t            },\n\t            trigger: function (eventName, eventType, data) {\n\t                var eventHandle = this.eventHandle;\n\t                if (eventType === 'DEFAULT') {\n\t                    eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n\t                }\n\t                else if (eventType === 'DELAY') {\n\t                    if (_lib.has(eventHandle.listened, eventName)) {\n\t                        eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n\t                    }\n\t                    if (!_lib.has(eventHandle.events, eventName)) {\n\t                        eventHandle.events[eventName] = [];\n\t                    }\n\t                    eventHandle.events[eventName].push(data);\n\t                }\n\t                else if (eventType === 'STATUS') {\n\t                    if (!_lib.has(eventHandle.events, eventType + \":\" + eventName)) {\n\t                        eventHandle.events[(eventType + \":\" + eventName)] = data;\n\t                        if (_lib.has(eventHandle.listened, eventName)) {\n\t                            eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n\t                        }\n\t                    }\n\t                }\n\t            },\n\t            off: function (eventName) {\n\t                var eventHandle = this.eventHandle;\n\t                eventHandle.off(eventName);\n\t                delete eventHandle.listened[eventName];\n\t                delete eventHandle.events[eventName];\n\t            },\n\t            init: function () {\n\t                var _a = this, inited = _a.inited, _temp = _a._temp, TYPE_ON = _a.TYPE_ON, TYPE_TRIGGER = _a.TYPE_TRIGGER;\n\t                if (!inited && _temp.length) {\n\t                    for (var _i = 0, _temp_1 = _temp; _i < _temp_1.length; _i++) {\n\t                        var item = _temp_1[_i];\n\t                        if (item.type === TYPE_ON) {\n\t                            this.on(item.eventName, item.callback);\n\t                        }\n\t                        else if (item.type === TYPE_TRIGGER) {\n\t                            this.trigger(item.eventName, item.eventTYpe, item.data);\n\t                        }\n\t                    }\n\t                    inited = true;\n\t                }\n\t            }\n\t        });\n\t    };\n\t    return Ndoo;\n\t}(prep_1.Prep));\n\texports.Ndoo = Ndoo;\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar api_1 = __webpack_require__(4);\n\tvar basic_1 = __webpack_require__(5);\n\tvar prepData_1 = __webpack_require__(6);\n\tvar prepData = prepData_1.getPrepData();\n\tvar Prep = (function (_super) {\n\t    __extends(Prep, _super);\n\t    function Prep() {\n\t        _super.call(this);\n\t        this._isDebug = false;\n\t        this.event = basic_1.EventBasic;\n\t        this.vars = {};\n\t        this.func = {};\n\t        this._lib = {};\n\t        if (prepData) {\n\t            this.vars = prepData.vars;\n\t            this.func = prepData.func;\n\t        }\n\t    }\n\t    return Prep;\n\t}(api_1.EventApi));\n\texports.Prep = Prep;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar EventApi = (function () {\n\t    function EventApi() {\n\t    }\n\t    EventApi.prototype.on = function (eventName, callback) {\n\t        eventName = eventName.split(/\\s*,\\s*|\\s+/);\n\t        for (var _i = 0, _a = eventName; _i < _a.length; _i++) {\n\t            var e = _a[_i];\n\t            this.event.on(e, callback);\n\t        }\n\t    };\n\t    EventApi.prototype.trigger = function (eventName) {\n\t        var data = [];\n\t        for (var _i = 1; _i < arguments.length; _i++) {\n\t            data[_i - 1] = arguments[_i];\n\t        }\n\t        var _index = eventName.indexOf(':');\n\t        var type = eventName.substring(0, _index++) || 'DEFAULT';\n\t        var e = eventName.substring(_index);\n\t        this.event.trigger(e, type, data);\n\t    };\n\t    EventApi.prototype.off = function (eventName) {\n\t        eventName = eventName.split(/\\s*,\\s*|\\s+/);\n\t        for (var _i = 0, _a = eventName; _i < _a.length; _i++) {\n\t            var e = _a[_i];\n\t            this.event.off(e);\n\t        }\n\t    };\n\t    return EventApi;\n\t}());\n\texports.EventApi = EventApi;\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar prepData_1 = __webpack_require__(6);\n\tvar prepData = prepData_1.getPrepData();\n\tvar EventBasic = (function () {\n\t    function EventBasic(name, type) {\n\t        return \"#\" + name + \":#\" + type;\n\t    }\n\t    EventBasic.on = function (eventName, callback) {\n\t        this._temp.push({\n\t            type: this.TYPE_ON,\n\t            eventName: eventName, callback: callback\n\t        });\n\t    };\n\t    EventBasic.trigger = function (eventName, eventType, data) {\n\t        this._temp.push({\n\t            type: this.TYPE_TRIGGER,\n\t            eventName: eventName, eventType: eventType, data: data\n\t        });\n\t    };\n\t    EventBasic.off = function (eventName) { };\n\t    EventBasic.init = function () { };\n\t    EventBasic.TYPE_ON = 1;\n\t    EventBasic.TYPE_TRIGGER = 2;\n\t    EventBasic.inited = false;\n\t    EventBasic._temp = prepData ? prepData.eventData : [];\n\t    return EventBasic;\n\t}());\n\texports.EventBasic = EventBasic;\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\texports.getPrepData = function () {\n\t    if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n\t        return window['ndoo_prep_data'];\n\t    }\n\t    return false;\n\t};\n\texports.setPrepData = function () {\n\t    var _self = {};\n\t    if (typeof window != 'undefined') {\n\t        _self = window;\n\t    }\n\t    if (!_self.ndoo_prep_data) {\n\t        _self.ndoo_prep_data = {\n\t            eventData: [],\n\t            func: {},\n\t            vars: {}\n\t        };\n\t    }\n\t};\n\texports.removePrepData = function () {\n\t    if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n\t        delete window['ndoo_prep_data'];\n\t    }\n\t};\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar Storage = (function () {\n\t    function Storage(key, value, option) {\n\t        var _self = Storage;\n\t        var destroy = option & _self.DESTROY;\n\t        var rewrite = option & _self.REWRITE;\n\t        var data = _self._data;\n\t        if (value === undefined) {\n\t            return data[key];\n\t        }\n\t        if (destroy) {\n\t            delete data[key];\n\t            return true;\n\t        }\n\t        if (!rewrite && _self._lib.has(data, key)) {\n\t            return false;\n\t        }\n\t        return data[key] = value;\n\t    }\n\t    Storage._data = {};\n\t    Storage.REWRITE = 1;\n\t    Storage.DESTROY = 2;\n\t    return Storage;\n\t}());\n\texports.Storage = Storage;\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar Router = (function () {\n\t    function Router() {\n\t    }\n\t    Router.parse = function (route, url, callback) {\n\t        var routeMatch = route.exec(url);\n\t        if (routeMatch != null) {\n\t            callback.apply(null, routeMatch.slice(1));\n\t        }\n\t    };\n\t    return Router;\n\t}());\n\texports.Router = Router;\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar _ = __webpack_require__(10);\n\tvar depend = __webpack_require__(11);\n\tvar event_1 = __webpack_require__(14);\n\texports._lib = _.extend({ Events: event_1.Events }, depend, _);\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar jquery = __webpack_require__(12);\n\tvar zepto = __webpack_require__(13);\n\tvar $ = jquery || zepto;\n\tvar depend = {};\n\tif ($) {\n\t    depend.onready = function (callback) {\n\t        $(callback);\n\t    };\n\t    depend.onload = function (callback) {\n\t        $(window).on('load', callback);\n\t    };\n\t    depend.querySelector = function (selector) {\n\t        $(selector).slice(0);\n\t    };\n\t    depend.data = function (elem, key, value) {\n\t        if (arguments.length === 2) {\n\t            return $(elem).data(key);\n\t        }\n\t        else if (arguments.length === 3) {\n\t            return $(elem).data(key, value);\n\t        }\n\t    };\n\t}\n\telse {\n\t    depend.onready = function (callback) {\n\t        document.addEventListener('DOMContentLoaded', callback, false);\n\t    };\n\t    depend.onload = function (callback) {\n\t        addEventListener('load', callback, false);\n\t    };\n\t    depend.querySelector = function (selector) {\n\t        document.querySelectorAll(selector);\n\t    };\n\t    depend.data = function (elem, key, value) {\n\t        if (!elem.dataset) {\n\t            key = key.replace(/([A-Z])/g, function (char) { return '-' + char.toLocaleLowerCase(); });\n\t        }\n\t        if (arguments.length === 2) {\n\t            if (elem.dataset) {\n\t                return elem.dataset[key];\n\t            }\n\t            else {\n\t                return elem.getAttribute(key);\n\t            }\n\t        }\n\t        else if (arguments.length === 3) {\n\t            if (elem.dataset) {\n\t                elem.dataset[key] = value;\n\t            }\n\t            else {\n\t                elem.setAttribute(key, value);\n\t            }\n\t        }\n\t    };\n\t}\n\texports.onready = depend.onready, exports.onload = depend.onload, exports.querySelector = depend.querySelector, exports.data = depend.data;\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n/***/ },\n/* 13 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_13__;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar _ = __webpack_require__(10);\n\tvar Backbone = __webpack_require__(15);\n\tvar Events = {};\n\texports.Events = Events;\n\tif (Backbone) {\n\t    exports.Events = Events = Backbone.Events;\n\t}\n\telse {\n\t    var eventSplitter = /\\s+/;\n\t    var eventsApi = function (iteratee, events, name, callback, opts) {\n\t        var i = 0, names;\n\t        if (name && typeof name === 'object') {\n\t            if (callback !== void 0 && 'context' in opts && opts.context === void 0)\n\t                opts.context = callback;\n\t            for (names = _.keys(name); i < names.length; i++) {\n\t                events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\n\t            }\n\t        }\n\t        else if (name && eventSplitter.test(name)) {\n\t            for (names = name.split(eventSplitter); i < names.length; i++) {\n\t                events = iteratee(events, names[i], callback, opts);\n\t            }\n\t        }\n\t        else {\n\t            events = iteratee(events, name, callback, opts);\n\t        }\n\t        return events;\n\t    };\n\t    Events.on = function (name, callback, context) {\n\t        return internalOn(this, name, callback, context);\n\t    };\n\t    var internalOn = function (obj, name, callback, context, listening) {\n\t        obj._events = eventsApi(onApi, obj._events || {}, name, callback, {\n\t            context: context,\n\t            ctx: obj,\n\t            listening: listening\n\t        });\n\t        if (listening) {\n\t            var listeners = obj._listeners || (obj._listeners = {});\n\t            listeners[listening.id] = listening;\n\t        }\n\t        return obj;\n\t    };\n\t    Events.listenTo = function (obj, name, callback) {\n\t        if (!obj)\n\t            return this;\n\t        var id = obj._listenId || (obj._listenId = _.uniqueId('l'));\n\t        var listeningTo = this._listeningTo || (this._listeningTo = {});\n\t        var listening = listeningTo[id];\n\t        if (!listening) {\n\t            var thisId = this._listenId || (this._listenId = _.uniqueId('l'));\n\t            listening = listeningTo[id] = { obj: obj, objId: id, id: thisId, listeningTo: listeningTo, count: 0 };\n\t        }\n\t        internalOn(obj, name, callback, this, listening);\n\t        return this;\n\t    };\n\t    var onApi = function (events, name, callback, options) {\n\t        if (callback) {\n\t            var handlers = events[name] || (events[name] = []);\n\t            var context = options.context, ctx = options.ctx, listening = options.listening;\n\t            if (listening)\n\t                listening.count++;\n\t            handlers.push({ callback: callback, context: context, ctx: context || ctx, listening: listening });\n\t        }\n\t        return events;\n\t    };\n\t    Events.off = function (name, callback, context) {\n\t        if (!this._events)\n\t            return this;\n\t        this._events = eventsApi(offApi, this._events, name, callback, {\n\t            context: context,\n\t            listeners: this._listeners\n\t        });\n\t        return this;\n\t    };\n\t    Events.stopListening = function (obj, name, callback) {\n\t        var listeningTo = this._listeningTo;\n\t        if (!listeningTo)\n\t            return this;\n\t        var ids = obj ? [obj._listenId] : _.keys(listeningTo);\n\t        for (var i = 0; i < ids.length; i++) {\n\t            var listening = listeningTo[ids[i]];\n\t            if (!listening)\n\t                break;\n\t            listening.obj.off(name, callback, this);\n\t        }\n\t        if (_.isEmpty(listeningTo))\n\t            this._listeningTo = void 0;\n\t        return this;\n\t    };\n\t    var offApi = function (events, name, callback, options) {\n\t        if (!events)\n\t            return;\n\t        var i = 0, listening;\n\t        var context = options.context, listeners = options.listeners;\n\t        if (!name && !callback && !context) {\n\t            var ids = _.keys(listeners);\n\t            for (; i < ids.length; i++) {\n\t                listening = listeners[ids[i]];\n\t                delete listeners[listening.id];\n\t                delete listening.listeningTo[listening.objId];\n\t            }\n\t            return;\n\t        }\n\t        var names = name ? [name] : _.keys(events);\n\t        for (; i < names.length; i++) {\n\t            name = names[i];\n\t            var handlers = events[name];\n\t            if (!handlers)\n\t                break;\n\t            var remaining = [];\n\t            for (var j = 0; j < handlers.length; j++) {\n\t                var handler = handlers[j];\n\t                if (callback && callback !== handler.callback &&\n\t                    callback !== handler.callback._callback ||\n\t                    context && context !== handler.context) {\n\t                    remaining.push(handler);\n\t                }\n\t                else {\n\t                    listening = handler.listening;\n\t                    if (listening && --listening.count === 0) {\n\t                        delete listeners[listening.id];\n\t                        delete listening.listeningTo[listening.objId];\n\t                    }\n\t                }\n\t            }\n\t            if (remaining.length) {\n\t                events[name] = remaining;\n\t            }\n\t            else {\n\t                delete events[name];\n\t            }\n\t        }\n\t        if (_.size(events))\n\t            return events;\n\t    };\n\t    Events.once = function (name, callback, context) {\n\t        var events = eventsApi(onceMap, {}, name, callback, _.bind(this.off, this));\n\t        return this.on(events, void 0, context);\n\t    };\n\t    Events.listenToOnce = function (obj, name, callback) {\n\t        var events = eventsApi(onceMap, {}, name, callback, _.bind(this.stopListening, this, obj));\n\t        return this.listenTo(obj, events);\n\t    };\n\t    var onceMap = function (map, name, callback, offer) {\n\t        if (callback) {\n\t            var once = map[name] = _.once(function () {\n\t                offer(name, once);\n\t                callback.apply(this, arguments);\n\t            });\n\t            once._callback = callback;\n\t        }\n\t        return map;\n\t    };\n\t    Events.trigger = function (name) {\n\t        if (!this._events)\n\t            return this;\n\t        var length = Math.max(0, arguments.length - 1);\n\t        var args = Array(length);\n\t        for (var i = 0; i < length; i++)\n\t            args[i] = arguments[i + 1];\n\t        eventsApi(triggerApi, this._events, name, void 0, args);\n\t        return this;\n\t    };\n\t    var triggerApi = function (objEvents, name, cb, args) {\n\t        if (objEvents) {\n\t            var events = objEvents[name];\n\t            var allEvents = objEvents.all;\n\t            if (events && allEvents)\n\t                allEvents = allEvents.slice();\n\t            if (events)\n\t                triggerEvents(events, args);\n\t            if (allEvents)\n\t                triggerEvents(allEvents, [name].concat(args));\n\t        }\n\t        return objEvents;\n\t    };\n\t    var triggerEvents = function (events, args) {\n\t        var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n\t        switch (args.length) {\n\t            case 0:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx);\n\t                return;\n\t            case 1:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx, a1);\n\t                return;\n\t            case 2:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx, a1, a2);\n\t                return;\n\t            case 3:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx, a1, a2, a3);\n\t                return;\n\t            default:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.apply(ev.ctx, args);\n\t                return;\n\t        }\n\t    };\n\t    Events.bind = Events.on;\n\t    Events.unbind = Events.off;\n\t}\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_15__;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t(function (RegType) {\n\t    RegType[RegType[\"App\"] = 0] = \"App\";\n\t    RegType[RegType[\"Block\"] = 1] = \"Block\";\n\t    RegType[RegType[\"Service\"] = 2] = \"Service\";\n\t})(exports.RegType || (exports.RegType = {}));\n\tvar RegType = exports.RegType;\n\texports.getComponent = function (ndoo) {\n\t    return function (path, type, isStatic) {\n\t        if (isStatic === void 0) { isStatic = false; }\n\t        return function (component) {\n\t            var instance = component;\n\t            if (!isStatic) {\n\t                instance = new component();\n\t            }\n\t            var method = '';\n\t            switch (type) {\n\t                case RegType.App:\n\t                    method = 'app';\n\t                    break;\n\t                case RegType.Block:\n\t                    method = 'block';\n\t                    break;\n\t                case RegType.Service:\n\t                    method = 'service';\n\t                    break;\n\t            }\n\t            method && ndoo[method](path, instance);\n\t        };\n\t    };\n\t};\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** dist/ndoo.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap b2d1c5769031e6448a59\n **/","import { Ndoo } from './src/ndoo';\n\nexport = new Ndoo();\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/ndoo.ts\n **/","import { Prep } from './prep';\nimport { Storage } from './storage';\nimport { Router } from './router';\nimport { _lib as lib } from './lib';\nimport { getPrepData, removePrepData } from './prepData';\nimport { RegType, getComponent } from './component';\n\nlet prepData = getPrepData();\n\nexport class Ndoo extends Prep {\n  public _lib = lib;\n  public pageId: string = '';\n  public initPageId(id: string) {\n    if (this.pageId) {\n      return;\n    }\n    if (typeof document != 'undefined') {\n      let el = document.getElementById(id || 'scriptArea');\n      if (el) {\n        this.pageId = el.getAttribute('data-page-id') || '';\n      }\n      if (!this.pageId && id) {\n        this.pageId = id;\n      }\n    }\n  }\n  private _pk: number = +new Date();\n  public getPk(prefix: string = '') {\n    return `${prefix}${++this._pk}`;\n  }\n  public storage: typeof Storage = Storage;\n  public router: typeof Router = Router;\n  private _loader = {\n    app: 'do',\n    block: 'do',\n    init: 'do',\n    appLoader: null,\n    blockLoader: null,\n    initLoader: null,\n    doLoader: function(depend: any[], callback: Function) {\n      Do.apply(null, depend.concat(callback));\n    },\n    seajsLoader: function(depend: any[], callback: Function) {\n      seajs.use(depend, callback);\n    }\n  };\n  public setLoader(type: string, loader: Function) {\n    this._loader[type] = `${type}Loader`;\n    this._loader[`${type}Loader`] = loader;\n  }\n  public require(depend: any[], callback: Function, type: string): void {\n    type = type.toLowerCase();\n    if (this._loader[`${type}Loader`]) {\n      this[type](depend, callback);\n    }\n    else {\n      throw new Error('require load is not define');\n    }\n  }\n  public _blockData = {\n    _block: {},\n    _app: {},\n    _service: {},\n    _exist: {}\n  }\n  public _block(base: string, ns: string, name: string, block?: any) {\n    let data: any;\n    let nsArr: string[];\n    if (base == 'block' || base == 'app' || base == 'service') {\n      data = this._blockData[`_${base}`];\n    }\n    else {\n      return false;\n    }\n\n    if (ns) {\n      nsArr = ns.replace(/^[/.]|[/.]$/g, '').split(/[/.]/);\n    }\n    else {\n      nsArr = [];\n    }\n\n    let temp = data;\n    let result: any;\n    let success: boolean;\n    if (block || arguments.length > 3) {\n      for (let ns of nsArr) {\n        temp = temp[ns] || (temp[ns] = {});\n      }\n      // app/block\n      if (block && (base === 'app' || base === 'block')) {\n        if (typeof block === 'object') {\n          if (base === 'app' && temp[name]) {\n            result = this._lib.defaults(temp[name], block);\n          }\n          else {\n            result = temp[name] = block;\n          }\n        }\n        else if (typeof block === 'function') {\n          result = temp[name] = block;\n        }\n        else {\n          result = false;\n        }\n      }\n      else if (base == 'service') {\n        result = temp[name] = block;\n        success = true;\n      }\n      else {\n        result = false;\n      }\n\n      if (result || success) {\n        if (ns) {\n          this._blockData._exist[`${base}.${ns}.${name}`] = true;\n        }\n        else {\n          this._blockData._exist[`${base}.${name}`] = true;\n        }\n      }\n\n      return result;\n    }\n    else {\n      for (let ns of nsArr) {\n        if (!this._lib.has(temp, ns)) {\n          return undefined;\n        }\n        temp = temp[ns];\n      }\n      return temp[name];\n    }\n  }\n  hasApp(ns: string) {\n    return this._blockData._exist[`app.${ns}`]\n  }\n  setApp(ns: string) {\n    return this._blockData._exist[`app.${ns}`] = true;\n  }\n  app(ns: string, app?: any) {\n    let nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let appName: string;\n    if (!nsmatch) {\n      nsmatch = [, null, ns]\n    }\n    [, ns, appName] = nsmatch;\n\n    if (arguments.length > 1) {\n      return this._block('app', ns, appName, app);\n    }\n    else {\n      return this._block('app', ns, appName);\n    }\n  }\n  _blockExist(ns: string, set: boolean = false) {\n    let nsmatch: string[] = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let name: string;\n    if (!nsmatch) {\n      nsmatch = [, '_default', ns];\n\n    }\n    [, ns, name] = nsmatch;\n    if (set) {\n      return this._blockData._exist[`block.${ns}.${name}`] = true;\n    }\n    else {\n      return this._blockData._exist[`block.${ns}.${name}`]\n    }\n  }\n  hasBlock(ns: string) {\n    return this._blockExist(ns);\n  }\n  setBlock(ns: string) {\n    return this._blockExist(ns, true);\n  }\n  block(ns: string, block?: any) {\n    let nsmatch: string[] = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let name: string;\n    if (!nsmatch) {\n      nsmatch = [, 'default', ns];\n    }\n    [ns, name] = nsmatch;\n    if (arguments.length > 1) {\n      return this._block('block', ns, name, block);\n    }\n    else {\n      return this._block('block', ns, name);\n    }\n  }\n  initBlock(elem: HTMLElement) {\n    let {_lib, router} = this;\n    let blockId: string | string[] = _lib.data(elem, 'nblockId');\n    blockId = (<string>blockId).split(/\\s*,\\s*|\\s+/);\n\n    let _call = (blockId: string) => {\n      router.parse(\n        /^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/,\n        blockId, (ns: string, blockName: string, params: string) => {\n          ns = ns.replace(/\\//g, '.');\n          let pkg: string = `${ns}.${blockName}`;\n          if (this.block(pkg)) {\n            this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n          }\n          else if (this.hasBlock(pkg)) {\n            this.require([`${ns}.${blockName}`], () => {\n              this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n            }, this._loader['block']);\n          }\n        });\n    }\n    _lib.each(blockId, (id: string) => {\n      let _self = this;\n      _call.call(_self, id);\n    });\n  }\n  private _bindBlockEvent() {\n    this.on('NBLOCK_LOADED', (elem, ns, name, params) => {\n      ns == null && (ns = '_default');\n      let block = this.block(`${ns}.${name}`);\n      if (block) {\n        if (this._lib.isFunction(block.init)) {\n          let call = () => {\n            block.init(elem, params);\n          }\n\n          if (block.depend) {\n            this.require([].concat(block.depend), call, this._loader['block']);\n          }\n          else {\n            call();\n          }\n        }\n        else if (this._lib.isFunction(block)) {\n          block(elem, params);\n        }\n      }\n    });\n    this.on('NBLOCK_INIT', () => {\n      let blockEl = this._lib.querySelector('[data-nblock-id]');\n      if (!blockEl || !blockEl.length) {\n        return;\n      }\n      let blocks:any[] = [];\n      for (let el of blockEl) {\n        let auto = this._lib.data(el, 'nblockAuto');\n        let level = parseInt(this._lib.data(el, 'nblockLevel')) || 5;\n        blocks.push([level, auto, el]);\n      }\n      blocks = blocks.sort((block1: any, block2: any) => block1[0] - block2[0]);\n      for (let item of blocks) {\n        let [, auto, block] = item;\n        if (auto === undefined || auto.toString() != 'false') {\n          this.initBlock(block);\n        }\n      }\n    });\n  }\n  service(ns: string, service: any) {\n    let nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let name: string;\n\n    if (!nsmatch) {\n      nsmatch = [, '_default', ns];\n    }\n    [, ns, name] = nsmatch;\n\n    if (arguments.length > 1) {\n      return this._block('service', ns, name, service);\n    }\n    else {\n      service = this._block('service', ns, name);\n      if (service && this._lib.isFunction(service.init)) {\n        return service.init();\n      }\n      else {\n        return service\n      }\n    }\n  }\n  dispatch() {\n    let {  _lib } = this;\n    let filterHaldner = (type: string, controller: any, actionName: string, params: string) => {\n      let data: any;\n      let { _lib } = this;\n      if (type === 'before') {\n        data = controller.before\n      }\n      else if (type === 'after') {\n        data = controller.after;\n      }\n      if (!data) {\n        return;\n      }\n      let _data: any[];\n      if (typeof data === 'object') {\n        _data = [].concat(data);\n      }\n      for (let dataItem of _data) {\n        let _filter = dataItem.filter;\n        if (!_lib.isArray(_filter)) {\n          _filter = [].concat(_filter.split(/\\s*,\\s*|\\s+/))\n        }\n        let isRun = true;\n        if (dataItem.only) {\n          let _only = dataItem.only;\n          if (!_lib.isArray(_only)) {\n            _only = [].concat(_only.split(/\\s*,\\s*|\\s+/))\n          }\n          if (_lib.indexOf(_only, actionName) < 0) {\n            isRun = false\n          }\n        }\n        else if (dataItem.except) {\n          let _except = dataItem.except;\n          if (!_lib.isArray(_except)) {\n            _except = [].concat(_except.split(/\\s*,\\s*|\\s+/))\n          }\n          if (_lib.indexOf(_except, actionName) > -1) {\n            isRun = false;\n          }\n        }\n        if (isRun) {\n          for (let filter of _filter) {\n            controller[`${filter}Filter`](actionName, params);\n          }\n        }\n      }\n    }\n    this.on(\n      'NAPP_ACTION_BEFORE',\n      (...data: any[]) => filterHaldner.apply(null, ['before'].concat(data))\n    );\n    this.on(\n      'NAPP_ACTION_AFTER',\n      (...data: any[]) => filterHaldner.apply(null, ['after'].concat(data))\n    );\n    this.on('NAPP_LOADED', (ns: string, appName: string, actionName: string, params) => {\n      let appData: any;\n      let _self = this;\n      if (ns) {\n        appData = this.app(`${ns}.${appName}`)\n      }\n      else {\n        appData = this.app(appName)\n      }\n\n      if (!_lib.has(appData, `${actionName}Action`) \n        && _lib.has(appData, 'emptyAction')) {\n          actionName = '_empty';\n      }\n\n      let depend = [];\n\n      if (appData['depend']) {\n        depend = depend.concat(appData['depend']);\n      }\n\n      if (appData[`${actionName}Depend`]) {\n        depend = depend.concat(appData[`${actionName}Depend`]);\n      }\n\n      let filterPrefix = appName;\n      if (ns) {\n        filterPrefix = (`${ns}.${appName}`).replace(/\\./g, '_')\n      }\n      filterPrefix = filterPrefix.toUpperCase();\n\n      let run = function() {\n        let args: any[] = [].slice.call(arguments, 0);\n        args.unshift(params);\n        if (actionName) {\n          _self.trigger('NAPP_ACTION_BEFORE', appData, actionName, params);\n          _self.trigger(`NAPP_${filterPrefix}_ACTION_BEFORE`, appData, actionName, params);\n\n          if (appData[`${actionName}Before`]) {\n            appData[`${actionName}Before`].apply(appData, args);\n          }\n          if (appData[`${actionName}Action`]) {\n            appData[`${actionName}Action`].apply(appData, args);\n          }\n          if (appData[`${actionName}After`]) {\n            appData[`${actionName}After`].apply(appData, args);\n          }\n\n          _self.trigger(`NAPP_${filterPrefix}_ACTION_AFTER`, appData, actionName, params);\n          _self.trigger('NAPP_ACTION_AFTER', appData, actionName, params);\n        }\n        _self.trigger('STATUS:NBLOCK_INIT');\n      }\n\n      if (depend.length) {\n        this.require(_lib.uniq(depend), run, this._loader['app']);\n      }\n      else {\n        run();\n      }\n    });\n    this.on('PAGE_STATUS_ROUTING', (data) => {\n      this.router.parse(\n        /^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/,\n        data, (appName: string, actionName: string, params: string) => {\n        let nsmatch = appName.match(/(.*?)(?:[/.]([^/.]+))$/);\n        let ns: string = '';\n        if (nsmatch) {\n          [, ns, appName] = nsmatch;\n        }\n        let pkg: string;\n        if (ns) {\n          ns = ns.replace(/\\//g, '.');\n          pkg = `${ns}.${appName}`;\n        }\n        else {\n          pkg = appName;\n        }\n\n        if (this.app(pkg)) {\n          this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n        }\n        else if (this.hasApp(pkg)) {\n          this.require([pkg], function() {\n            this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n          }, this._loader['app']);\n        }\n        else {\n          this.trigger('STATUS:NBLOCK_INIT');\n        }\n      });\n    });\n  }\n  public triggerPageStatus(depend: string | string[]) {\n    let { _lib } = this;\n    let call = () => {\n      this.trigger('STATUS:PAGE_STATUS_FAST')\n\n      _lib.onready(() => {\n        this.trigger('STATUS:PAGE_STATUS_DOMPREP');\n        this.trigger('STATUS:PAGE_STATUS_DOM');\n        this.trigger('STATUS:PAGE_STATUS_DOMORLOAD');\n      });\n\n      _lib.onload(() => {\n        this.trigger('STATUS:PAGE_STATUS_LOAD');\n      });\n\n      this.on('PAGE_STATUS_DOM', () => {\n        if (this.pageId) {\n          this.trigger('STATUS:PAGE_STATUS_ROUTING', this.pageId);\n        }\n      });\n    }\n    depend ? this.require([].concat(depend), call, this._loader['init']) : call();\n  }\n  init(id?: string | string[], depend?: string| string[]) {\n    let { _lib } = this;\n    if (_lib.isArray(id)) {\n      [id, depend] = ['', id];\n    }\n\n    this.initPageId(<string>id);\n    this.dispatch();\n    this.triggerPageStatus(depend);\n    return this;\n  }\n  private _rebuildEvent() {\n    let { _lib } = this;\n    let eventHandle = _lib.extend({\n      events: {},\n      listened: {}\n    }, _lib.Events);\n    this.event = _lib.extend(this.event, {\n      eventHandle,\n      on: function(eventName: string, callback: Function) {\n        let { eventHandle } = this;\n        eventHandle.on(eventName, callback);\n        eventHandle.listened[eventName] = true;\n        if (_lib.has(eventHandle.events, `STATUS:${eventName}`)) {\n          callback.apply(eventHandle, eventHandle.events[`STATUS:${eventName}`]);\n        }\n        if (_lib.has(eventHandle.events, eventName)) {\n          for (let item of eventHandle.events[eventName]) {\n            callback.apply(eventHandle, item);\n          }\n        }\n      },\n      trigger: function(eventName: string, eventType: string, data: any[]) {\n        let { eventHandle } = this;\n        if (eventType === 'DEFAULT') {\n          eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n        }\n        else if (eventType === 'DELAY') {\n          if (_lib.has(eventHandle.listened, eventName)) {\n            eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n          }\n          if (!_lib.has(eventHandle.events, eventName)) {\n            eventHandle.events[eventName] = []\n          }\n          eventHandle.events[eventName].push(data);\n        }\n        else if (eventType === 'STATUS') {\n          if (!_lib.has(eventHandle.events, `${eventType}:${eventName}`)) {\n            eventHandle.events[`${eventType}:${eventName}`] = data;\n            if (_lib.has(eventHandle.listened, eventName)) {\n              eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n            }\n          }\n        } \n      },\n      off: function(eventName: string) {\n        let { eventHandle } = this;\n        eventHandle.off(eventName);\n        delete eventHandle.listened[eventName];\n        delete eventHandle.events[eventName];\n      },\n      init: function() {\n        let { inited, _temp, TYPE_ON, TYPE_TRIGGER } = this;\n        if (!inited && _temp.length) {\n          for (let item of _temp) {\n            if (item.type === TYPE_ON) {\n              this.on(item.eventName, item.callback);\n            }\n            else if (item.type === TYPE_TRIGGER) {\n              this.trigger(item.eventName, item.eventTYpe, item.data);\n            }\n          }\n          inited = true;\n        }\n      }\n    });\n  }\n  public RegType = RegType;\n  public Component = getComponent(this);\n  constructor() {\n    super();\n    this.storage._lib = this._lib;\n\n    this._rebuildEvent();\n    this.event.init();\n\n    this.trigger('STATUS:NAPP_DEFINE');\n    this.trigger('STATUS:NBLOCK_DEFINE');\n    this.trigger('STATUS:NSERVICE_DEFINE');\n    this._bindBlockEvent();\n\n    if (prepData) {\n      removePrepData();\n    }\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/ndoo.ts\n **/","import { EventApi } from './event/api';\nimport { EventBasic } from './event/basic';\nimport { getPrepData, PrepDataType } from './prepData';\nlet prepData = getPrepData();\n\nclass Prep extends EventApi {\n  public _isDebug: boolean = false;\n  public event: typeof EventBasic = EventBasic;\n\n  public vars: any = {};\n  public func: any = {};\n  public _lib: any = {};\n\n  constructor() {\n    super();\n    if (prepData) {\n      this.vars = (prepData as PrepDataType).vars;\n      this.func = (prepData as PrepDataType).func;\n    }\n  }\n}\n\nexport { Prep }\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/prep.ts\n **/","import { EventBasic } from './basic';\nexport class EventApi {\n  public event: typeof EventBasic;\n  public on(eventName: string | string[], callback: Function) {\n    eventName = (<string>eventName).split(/\\s*,\\s*|\\s+/);\n    for (let e of <string[]>eventName) {\n        this.event.on(e, callback);\n    }\n  }\n  public trigger(eventName: string | string[], ...data: any[]) {\n    let _index = eventName.indexOf(':');\n    let type = (<string>eventName).substring(0, _index++) || 'DEFAULT';\n    let e = (<string>eventName).substring(_index);\n\n    this.event.trigger(e, type, data);\n  }\n  public off(eventName: string | string[]) {\n    eventName = (<string>eventName).split(/\\s*,\\s*|\\s+/);\n    for(let e of <string[]>eventName) {\n        this.event.off(e);\n    }\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/event/api.ts\n **/","import { getPrepData, PrepDataType } from '../prepData';\nlet prepData = getPrepData();\n\nexport class EventBasic {\n  constructor(name: string, type: string) {\n    return `#${name}:#${type}`;\n  }\n  static TYPE_ON = 1;\n  static TYPE_TRIGGER = 2;\n  static inited = false;\n  static _temp = prepData ? (prepData as PrepDataType).eventData : [];\n  static on(eventName: string, callback: Function) {\n    this._temp.push({\n      type: this.TYPE_ON,\n      eventName, callback\n    })\n  }\n  static trigger(eventName: string, eventType: string, data: any[]) {\n    this._temp.push({\n      type: this.TYPE_TRIGGER,\n      eventName, eventType, data\n    });\n  }\n  static off(eventName: string) { }\n  static init() {}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/event/basic.ts\n **/","export interface PrepDataType {\n  eventData: any[],\n  func: any,\n  vars: any\n}\n\nexport let getPrepData = function (): PrepDataType | boolean {\n  if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n    return window['ndoo_prep_data'];\n  }\n  return false;\n}\n\nexport let setPrepData = function () {\n  let _self: any = {};\n  if (typeof window != 'undefined') {\n    _self = window;\n  }\n  if (!_self.ndoo_prep_data) {\n    _self.ndoo_prep_data = {\n      eventData: [],\n      func: {},\n      vars: {}\n    };\n  }\n}\n\nexport let removePrepData = function () {\n  if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n    delete window['ndoo_prep_data'];\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/prepData.ts\n **/","export class Storage {\n  static _data: any = {};\n  static REWRITE: number = 1;\n  static DESTROY: number = 2;\n  static _lib: {\n      has(data: any, key: string): boolean;\n  };\n\n  constructor(key, value, option: number) {\n    let _self = Storage;\n    let destroy = option & _self.DESTROY;\n    let rewrite = option & _self.REWRITE;\n    let data = _self._data;\n\n    if (value === undefined) {\n      return data[key];\n    }\n\n    if (destroy) {\n      delete data[key];\n      return true;\n    }\n\n    if (!rewrite && _self._lib.has(data, key)) {\n      return false;\n    }\n\n    return data[key] = value;\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/storage.ts\n **/","export class Router {\n  static parse(route: RegExp, url: string, callback: Function) {\n    let routeMatch = route.exec(url);\n    if (routeMatch != null) {\n      callback.apply(null, routeMatch.slice(1));\n    }\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/router.ts\n **/","import * as _ from 'underscore';\nimport * as depend from './depend'\nimport { Events } from './event';\nexport let _lib = _.extend({ Events }, depend, _);\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/lib/index.ts\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"_\"\n ** module id = 10\n ** module chunks = 0\n **/","/// <references src=\"../declare.d.ts\" />\nimport * as jquery from 'jquery';\nimport * as zepto from 'zepto';\n\nlet $ = jquery || zepto;\nlet depend: any = {};\nif ($) {\n  depend.onready = function (callback: EventListener) {\n    $(callback);\n  }\n  depend.onload = function (callback: EventListener) {\n    $(window).on('load', callback);\n  }\n  depend.querySelector = function (selector: any) {\n    $(selector).slice(0);\n  }\n  depend.data = function (elem: HTMLElement, key: string, value: any) {\n    if (arguments.length === 2) {\n      return $(elem).data(key);\n    }\n    else if (arguments.length === 3) {\n      return $(elem).data(key, value);\n    }\n  }\n}\nelse {\n  depend.onready = function (callback: EventListener) {\n    document.addEventListener('DOMContentLoaded', callback, false);\n\n  }\n  depend.onload = function (callback: EventListener) {\n    addEventListener('load', callback, false);\n  }\n  depend.querySelector = function (selector: any) {\n    document.querySelectorAll(selector);\n  }\n  depend.data = function (elem: HTMLElement, key: string, value?: any) {\n    if (!elem.dataset) {\n      key = key.replace(/([A-Z])/g, (char) => '-' + char.toLocaleLowerCase());\n    }\n    if (arguments.length === 2) {\n      if (elem.dataset) {\n        return elem.dataset[key];\n      }\n      else {\n        return elem.getAttribute(key);\n      }\n    }\n    else if (arguments.length === 3) {\n      if (elem.dataset) {\n        elem.dataset[key] = value;\n      }\n      else {\n        elem.setAttribute(key, value);\n      }\n    }\n  }\n}\n\nexport let { onready, onload, querySelector, data } = depend;\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/lib/depend.ts\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"jQuery\"\n ** module id = 12\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_13__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Zepto\"\n ** module id = 13\n ** module chunks = 0\n **/","import * as _ from 'underscore';\nimport * as Backbone from 'backbone';\n\nlet Events: any = {};\n\nif (Backbone) {\n  Events = Backbone.Events;\n}\nelse {\n// Backbone.Events\n// ---------------\n\n// A module that can be mixed in to *any object* in order to provide it with\n// a custom event channel. You may bind a callback to an event with 'on' or\n// remove with 'off'; 'trigger'-ing an event fires all callbacks in\n// succession.\n//\n//     var object = {};\n//     _.extend(object, Backbone.Events);\n//     object.on('expand', function(){ alert('expanded'); });\n//     object.trigger('expand');\n//\n// var Events: any = {};\n\n// Regular expression used to split event strings.\nvar eventSplitter = /\\s+/;\n\n// Iterates over the standard 'event, callback' (as well as the fancy multiple\n// space-separated events '\"change blur\", callback' and jQuery-style event\n// maps '{event: callback}').\nvar eventsApi = function (iteratee, events, name, callback, opts) {\n  var i = 0, names;\n  if (name && typeof name === 'object') {\n    // Handle event maps.\n    if (callback !== void 0 && 'context' in opts && opts.context === void 0) opts.context = callback;\n    for (names = _.keys(name); i < names.length; i++) {\n      events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\n    }\n  } else if (name && eventSplitter.test(name)) {\n    // Handle space separated event names by delegating them individually.\n    for (names = name.split(eventSplitter); i < names.length; i++) {\n      events = iteratee(events, names[i], callback, opts);\n    }\n  } else {\n    // Finally, standard events.\n    events = iteratee(events, name, callback, opts);\n  }\n  return events;\n};\n\n// Bind an event to a 'callback' function. Passing '\"all\"' will bind\n// the callback to all events fired.\nEvents.on = function (name, callback, context) {\n  return internalOn(this, name, callback, context);\n};\n\n// Guard the 'listening' argument from the public API.\nvar internalOn = function (obj: any, name: any, callback: any, context: any, listening?: any) {\n  obj._events = eventsApi(onApi, obj._events || {}, name, callback, {\n    context: context,\n    ctx: obj,\n    listening: listening\n  });\n\n  if (listening) {\n    var listeners = obj._listeners || (obj._listeners = {});\n    listeners[listening.id] = listening;\n  }\n\n  return obj;\n};\n\n// Inversion-of-control versions of 'on'. Tell *this* object to listen to\n// an event in another object... keeping track of what it's listening to\n// for easier unbinding later.\nEvents.listenTo = function (obj, name, callback) {\n  if (!obj) return this;\n  var id = obj._listenId || (obj._listenId = _.uniqueId('l'));\n  var listeningTo = this._listeningTo || (this._listeningTo = {});\n  var listening = listeningTo[id];\n\n  // This object is not listening to any other events on 'obj' yet.\n  // Setup the necessary references to track the listening callbacks.\n  if (!listening) {\n    var thisId = this._listenId || (this._listenId = _.uniqueId('l'));\n    listening = listeningTo[id] = { obj: obj, objId: id, id: thisId, listeningTo: listeningTo, count: 0 };\n  }\n\n  // Bind callbacks on obj, and keep track of them on listening.\n  internalOn(obj, name, callback, this, listening);\n  return this;\n};\n\n// The reducing API that adds a callback to the 'events' object.\nvar onApi = function (events, name, callback, options) {\n  if (callback) {\n    var handlers = events[name] || (events[name] = []);\n    var context = options.context, ctx = options.ctx, listening = options.listening;\n    if (listening) listening.count++;\n\n    handlers.push({ callback: callback, context: context, ctx: context || ctx, listening: listening });\n  }\n  return events;\n};\n\n// Remove one or many callbacks. If 'context' is null, removes all\n// callbacks with that function. If 'callback' is null, removes all\n// callbacks for the event. If 'name' is null, removes all bound\n// callbacks for all events.\nEvents.off = function (name, callback, context) {\n  if (!this._events) return this;\n  this._events = eventsApi(offApi, this._events, name, callback, {\n    context: context,\n    listeners: this._listeners\n  });\n  return this;\n};\n\n// Tell this object to stop listening to either specific events ... or\n// to every object it's currently listening to.\nEvents.stopListening = function (obj, name, callback) {\n  var listeningTo = this._listeningTo;\n  if (!listeningTo) return this;\n\n  var ids = obj ? [obj._listenId] : _.keys(listeningTo);\n\n  for (var i = 0; i < ids.length; i++) {\n    var listening = listeningTo[ids[i]];\n\n    // If listening doesn't exist, this object is not currently\n    // listening to obj. Break out early.\n    if (!listening) break;\n\n    listening.obj.off(name, callback, this);\n  }\n  if (_.isEmpty(listeningTo)) this._listeningTo = void 0;\n\n  return this;\n};\n\n// The reducing API that removes a callback from the 'events' object.\nvar offApi = function (events, name, callback, options) {\n  if (!events) return;\n\n  var i = 0, listening;\n  var context = options.context, listeners = options.listeners;\n\n  // Delete all events listeners and \"drop\" events.\n  if (!name && !callback && !context) {\n    var ids = _.keys(listeners);\n    for (; i < ids.length; i++) {\n      listening = listeners[ids[i]];\n      delete listeners[listening.id];\n      delete listening.listeningTo[listening.objId];\n    }\n    return;\n  }\n\n  var names = name ? [name] : _.keys(events);\n  for (; i < names.length; i++) {\n    name = names[i];\n    var handlers = events[name];\n\n    // Bail out if there are no events stored.\n    if (!handlers) break;\n\n    // Replace events if there are any remaining.  Otherwise, clean up.\n    var remaining = [];\n    for (var j = 0; j < handlers.length; j++) {\n      var handler = handlers[j];\n      if (\n        callback && callback !== handler.callback &&\n        callback !== handler.callback._callback ||\n        context && context !== handler.context\n      ) {\n        remaining.push(handler);\n      } else {\n        listening = handler.listening;\n        if (listening && --listening.count === 0) {\n          delete listeners[listening.id];\n          delete listening.listeningTo[listening.objId];\n        }\n      }\n    }\n\n    // Update tail event if the list has any events.  Otherwise, clean up.\n    if (remaining.length) {\n      events[name] = remaining;\n    } else {\n      delete events[name];\n    }\n  }\n  if (_.size(events)) return events;\n};\n\n// Bind an event to only be triggered a single time. After the first time\n// the callback is invoked, its listener will be removed. If multiple events\n// are passed in using the space-separated syntax, the handler will fire\n// once for each event, not once for a combination of all events.\nEvents.once = function (name, callback, context) {\n  // Map the event into a '{event: once}' object.\n  var events = eventsApi(onceMap, {}, name, callback, _.bind(this.off, this));\n  return this.on(events, void 0, context);\n};\n\n// Inversion-of-control versions of 'once'.\nEvents.listenToOnce = function (obj, name, callback) {\n  // Map the event into a '{event: once}' object.\n  var events = eventsApi(onceMap, {}, name, callback, _.bind(this.stopListening, this, obj));\n  return this.listenTo(obj, events);\n};\n\n// Reduces the event callbacks into a map of '{event: onceWrapper}'.\n// 'offer' unbinds the 'onceWrapper' after it has been called.\nvar onceMap = function (map, name, callback, offer) {\n  if (callback) {\n    var once = map[name] = _.once(function () {\n      offer(name, once);\n      callback.apply(this, arguments);\n    });\n    once._callback = callback;\n  }\n  return map;\n};\n\n// Trigger one or many events, firing all bound callbacks. Callbacks are\n// passed the same arguments as 'trigger' is, apart from the event name\n// (unless you're listening on '\"all\"', which will cause your callback to\n// receive the true name of the event as the first argument).\nEvents.trigger = function (name) {\n  if (!this._events) return this;\n\n  var length = Math.max(0, arguments.length - 1);\n  var args = Array(length);\n  for (var i = 0; i < length; i++) args[i] = arguments[i + 1];\n\n  eventsApi(triggerApi, this._events, name, void 0, args);\n  return this;\n};\n\n// Handles triggering the appropriate event callbacks.\nvar triggerApi = function (objEvents, name, cb, args) {\n  if (objEvents) {\n    var events = objEvents[name];\n    var allEvents = objEvents.all;\n    if (events && allEvents) allEvents = allEvents.slice();\n    if (events) triggerEvents(events, args);\n    if (allEvents) triggerEvents(allEvents, [name].concat(args));\n  }\n  return objEvents;\n};\n\n// A difficult-to-believe, but optimized internal dispatch function for\n// triggering events. Tries to keep the usual cases speedy (most internal\n// Backbone events have 3 arguments).\nvar triggerEvents = function (events, args) {\n  var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n  switch (args.length) {\n    case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;\n    case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;\n    case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;\n    case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;\n    default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args); return;\n  }\n};\n\n// Aliases for backwards compatibility.\nEvents.bind = Events.on;\nEvents.unbind = Events.off;\n}\n\nexport { Events };\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/lib/event.ts\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_15__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Backbone\"\n ** module id = 15\n ** module chunks = 0\n **/","export enum RegType {\n  App,\n  Block,\n  Service\n}\n\nexport let getComponent = (ndoo: any) => {\n  /**\n   * ndoo\n   */\n  return (path: string, type: RegType, isStatic = false) => (component: any) => {\n    // \n    let instance = component;\n    if (!isStatic) {\n      instance = new component();\n    }\n    // \n    let method = '';\n    switch (type) {\n      case RegType.App:\n        method = 'app';\n        break;\n      case RegType.Block:\n        method = 'block';\n        break;\n      case RegType.Service:\n        method = 'service';\n        break;\n    }\n    // \n    method && ndoo[method](path, instance);\n  }\n}\n\n\n/** WEBPACK FOOTER **\n ** ./_source/ts/src/component.ts\n **/"],"sourceRoot":""}