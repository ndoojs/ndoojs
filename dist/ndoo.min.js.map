{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/ndoo.min.js","webpack:///webpack/bootstrap 9c669bdd9cda0e9cb705","webpack:///./_source/ts/ndoo.ts","webpack:///./_source/ts/src/ndoo.ts","webpack:///./_source/ts/src/prep.ts","webpack:///./_source/ts/src/event/api.ts","webpack:///./_source/ts/src/event/basic.ts","webpack:///./_source/ts/src/prepData.ts","webpack:///./_source/ts/src/storage.ts","webpack:///./_source/ts/src/router.ts","webpack:///./_source/ts/src/lib/index.ts","webpack:///external \"_\"","webpack:///./_source/ts/src/lib/depend.ts","webpack:///external \"jQuery\"","webpack:///external \"Zepto\"","webpack:///./_source/ts/src/lib/event.ts","webpack:///external \"Backbone\"","webpack:///./_source/ts/src/component.ts"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_10__","__WEBPACK_EXTERNAL_MODULE_12__","__WEBPACK_EXTERNAL_MODULE_13__","__WEBPACK_EXTERNAL_MODULE_15__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","ndoo_1","Ndoo","__extends","d","b","__","constructor","hasOwnProperty","prototype","Object","create","prep_1","storage_1","router_1","lib_1","prepData_1","component_1","prepData","getPrepData","_super","_this","_lib","pageId","_pk","Date","storage","Storage","router","Router","_loader","app","block","init","appLoader","blockLoader","initLoader","doLoader","depend","callback","Do","apply","concat","seajsLoader","seajs","use","_blockData","_block","_app","_service","_exist","RegType","Component","getComponent","_rebuildEvent","event","trigger","_bindBlockEvent","removePrepData","initPageId","document","el","getElementById","getAttribute","getPk","prefix","setLoader","type","loader","toLowerCase","Error","base","ns","name","data","nsArr","replace","split","result","success","temp","arguments","length","_i","nsArr_1","ns_1","defaults","_a","nsArr_2","ns_2","has","hasApp","setApp","appName","nsmatch","match","_blockExist","set","hasBlock","setBlock","initBlock","elem","blockId","_call","parse","blockName","params","pkg","each","_self","on","isFunction","blockEl","querySelector","blocks","blockEl_1","auto","level","parseInt","push","sort","block1","block2","blocks_1","item","undefined","toString","service","dispatch","filterHaldner","controller","actionName","before","after","_data","_data_1","dataItem","_filter","filter","isArray","isRun","only","_only","indexOf","except","_except","_filter_1","appData","filterPrefix","toUpperCase","run","args","slice","unshift","uniq","triggerPageStatus","onready","onload","eventHandle","extend","events","listened","Events","eventName","eventType","off","inited","_temp","TYPE_ON","TYPE_TRIGGER","_temp_1","eventTYpe","Prep","api_1","basic_1","EventBasic","vars","func","EventApi","e","_index","substring","eventData","window","setPrepData","ndoo_prep_data","key","value","option","destroy","DESTROY","rewrite","REWRITE","route","url","routeMatch","exec","_","event_1","jquery","zepto","$","selector","get","addEventListener","querySelectorAll","dataset","char","toLocaleLowerCase","setAttribute","Backbone","eventSplitter","eventsApi","iteratee","opts","names","i","context","keys","test","internalOn","obj","listening","_events","onApi","ctx","listeners","_listeners","listenTo","_listenId","uniqueId","listeningTo","_listeningTo","thisId","objId","count","options","handlers","offApi","stopListening","ids","isEmpty","remaining","j","handler","_callback","size","once","onceMap","bind","listenToOnce","map","offer","Math","max","Array","triggerApi","objEvents","cb","allEvents","all","triggerEvents","ev","l","a1","a2","a3","unbind","ndoo","path","isStatic","component","instance","method","App","Block","Service"],"mappings":"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","file":"./dist/ndoo.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"jQuery\", \"Zepto\", \"Backbone\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ndoo\"] = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse\n\t\troot[\"ndoo\"] = factory(root[\"_\"], root[\"jQuery\"], root[\"Zepto\"], root[\"Backbone\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_10__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_15__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"jQuery\", \"Zepto\", \"Backbone\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ndoo\"] = factory(require(\"_\"), require(\"jQuery\"), require(\"Zepto\"), require(\"Backbone\"));\n\telse\n\t\troot[\"ndoo\"] = factory(root[\"_\"], root[\"jQuery\"], root[\"Zepto\"], root[\"Backbone\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_10__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__, __WEBPACK_EXTERNAL_MODULE_15__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar ndoo_1 = __webpack_require__(2);\n\tmodule.exports = new ndoo_1.Ndoo();\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar prep_1 = __webpack_require__(3);\n\tvar storage_1 = __webpack_require__(7);\n\tvar router_1 = __webpack_require__(8);\n\tvar lib_1 = __webpack_require__(9);\n\tvar prepData_1 = __webpack_require__(6);\n\tvar component_1 = __webpack_require__(16);\n\tvar prepData = prepData_1.getPrepData();\n\tvar Ndoo = (function (_super) {\n\t    __extends(Ndoo, _super);\n\t    function Ndoo() {\n\t        var _this = _super.call(this) || this;\n\t        _this._lib = lib_1._lib;\n\t        /**\n\t         * page id\n\t         *\n\t         * @name pageId\n\t         * @memberof ndoo\n\t         * @type {string}\n\t         */\n\t        _this.pageId = '';\n\t        /**\n\t         * 内部_pk主键\n\t         *\n\t         * @private\n\t         * @name _pk\n\t         * @memberof ndoo\n\t         */\n\t        _this._pk = +new Date();\n\t        _this.storage = storage_1.Storage;\n\t        _this.router = router_1.Router;\n\t        _this._loader = {\n\t            app: 'do',\n\t            block: 'do',\n\t            init: 'do',\n\t            appLoader: null,\n\t            blockLoader: null,\n\t            initLoader: null,\n\t            doLoader: function (depend, callback) {\n\t                Do.apply(null, depend.concat(callback));\n\t            },\n\t            seajsLoader: function (depend, callback) {\n\t                seajs.use(depend, callback);\n\t            }\n\t        };\n\t        _this._blockData = {\n\t            _block: {},\n\t            _app: {},\n\t            _service: {},\n\t            _exist: {}\n\t        };\n\t        _this.RegType = component_1.RegType;\n\t        _this.Component = component_1.getComponent(_this);\n\t        _this.storage._lib = _this._lib;\n\t        _this._rebuildEvent();\n\t        _this.event.init();\n\t        _this.trigger('STATUS:NAPP_DEFINE');\n\t        _this.trigger('STATUS:NBLOCK_DEFINE');\n\t        _this.trigger('STATUS:NSERVICE_DEFINE');\n\t        _this._bindBlockEvent();\n\t        if (prepData) {\n\t            prepData_1.removePrepData();\n\t        }\n\t        return _this;\n\t        // this.RegType = RegType;\n\t        // this.Component = getComponent(this);\n\t    }\n\t    /**\n\t     * initPageId 初始化 pageId\n\t     *\n\t     * @private\n\t     * @name initPageId\n\t     * @memberof ndoo\n\t     */\n\t    Ndoo.prototype.initPageId = function (id) {\n\t        if (this.pageId) {\n\t            return;\n\t        }\n\t        if (typeof document != 'undefined') {\n\t            var el = document.getElementById(id || 'scriptArea');\n\t            if (el) {\n\t                this.pageId = el.getAttribute('data-page-id') || '';\n\t            }\n\t            if (!this.pageId && id) {\n\t                this.pageId = id;\n\t            }\n\t        }\n\t    };\n\t    /**\n\t     * 获取唯一key\n\t     *\n\t     * @method\n\t     * @name getPk\n\t     * @memberof ndoo\n\t     * @param prefix {string} 前缀\n\t     * @return {string} 键名\n\t     */\n\t    Ndoo.prototype.getPk = function (prefix) {\n\t        if (prefix === void 0) { prefix = ''; }\n\t        return \"\" + prefix + ++this._pk;\n\t    };\n\t    /**\n\t     * 设置加载器\n\t     *\n\t     * @method\n\t     * @name setLoader\n\t     * @memberof ndoo\n\t     * @param type {string} 加载器类型\n\t     * @param loader {Function} 加载器回调函数\n\t     */\n\t    Ndoo.prototype.setLoader = function (type, loader) {\n\t        this._loader[type] = type + \"Loader\";\n\t        this._loader[type + \"Loader\"] = loader;\n\t    };\n\t    /**\n\t     * 依赖加载方法\n\t     *\n\t     * @method\n\t     * @name require\n\t     * @memberof ndoo\n\t     * @param depend {array} 依赖\n\t     * @param callback {Function} 架设函数\n\t     * @param type {string} 加载器类型 app/block/service\n\t     */\n\t    Ndoo.prototype.require = function (depend, callback, type) {\n\t        type = type.toLowerCase();\n\t        if (this._loader[type + \"Loader\"]) {\n\t            this[type](depend, callback);\n\t        }\n\t        else {\n\t            throw new Error('require load is not define');\n\t        }\n\t    };\n\t    Ndoo.prototype._block = function (base, ns, name, block) {\n\t        var data;\n\t        var nsArr;\n\t        if (base == 'block' || base == 'app' || base == 'service') {\n\t            data = this._blockData[\"_\" + base];\n\t        }\n\t        else {\n\t            return false;\n\t        }\n\t        if (ns) {\n\t            nsArr = ns.replace(/^[/.]|[/.]$/g, '').split(/[/.]/);\n\t        }\n\t        else {\n\t            nsArr = [];\n\t        }\n\t        var temp = data;\n\t        var result;\n\t        var success;\n\t        if (block || arguments.length > 3) {\n\t            for (var _i = 0, nsArr_1 = nsArr; _i < nsArr_1.length; _i++) {\n\t                var ns_1 = nsArr_1[_i];\n\t                temp = temp[ns_1] || (temp[ns_1] = {});\n\t            }\n\t            // app/block只允许真值\n\t            if (block && (base === 'app' || base === 'block')) {\n\t                if (typeof block === 'object') {\n\t                    if (base === 'app' && temp[name]) {\n\t                        result = this._lib.defaults(temp[name], block);\n\t                    }\n\t                    else {\n\t                        result = temp[name] = block;\n\t                    }\n\t                }\n\t                else if (typeof block === 'function') {\n\t                    result = temp[name] = block;\n\t                }\n\t                else {\n\t                    result = false;\n\t                }\n\t            }\n\t            else if (base == 'service') {\n\t                result = temp[name] = block;\n\t                success = true;\n\t            }\n\t            else {\n\t                result = false;\n\t            }\n\t            if (result || success) {\n\t                if (ns) {\n\t                    this._blockData._exist[base + \".\" + ns + \".\" + name] = true;\n\t                }\n\t                else {\n\t                    this._blockData._exist[base + \".\" + name] = true;\n\t                }\n\t            }\n\t            return result;\n\t        }\n\t        else {\n\t            for (var _a = 0, nsArr_2 = nsArr; _a < nsArr_2.length; _a++) {\n\t                var ns_2 = nsArr_2[_a];\n\t                if (!this._lib.has(temp, ns_2)) {\n\t                    return undefined;\n\t                }\n\t                temp = temp[ns_2];\n\t            }\n\t            return temp[name];\n\t        }\n\t    };\n\t    /**\n\t     * 检测是否存在指定app\n\t     *\n\t     * @method\n\t     * @name hasApp\n\t     * @memberof ndoo\n\t     * @param {string} namespace 名称空间\n\t     * @return {boolean} 是否在存指定的app\n\t     */\n\t    Ndoo.prototype.hasApp = function (ns) {\n\t        return this._blockData._exist[\"app.\" + ns];\n\t    };\n\t    /**\n\t     * 标识指定app已存在\n\t     *\n\t     * @method\n\t     * @name setApp\n\t     * @memberof ndoo\n\t     * @param {string} namespace 名称空间\n\t     */\n\t    Ndoo.prototype.setApp = function (ns) {\n\t        return this._blockData._exist[\"app.\" + ns] = true;\n\t    };\n\t    /**\n\t     * 添加app实现\n\t     *\n\t     * @method\n\t     * @name app\n\t     * @memberof ndoo\n\t     * @param {string} namespace 名称空间\n\t     * @param {object} controller 控制器\n\t     */\n\t    Ndoo.prototype.app = function (ns, app) {\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var appName;\n\t        if (!nsmatch) {\n\t            nsmatch = [, null, ns];\n\t        }\n\t        ns = nsmatch[1], appName = nsmatch[2];\n\t        if (arguments.length > 1) {\n\t            return this._block('app', ns, appName, app);\n\t        }\n\t        else {\n\t            return this._block('app', ns, appName);\n\t        }\n\t    };\n\t    /**\n\t     * 检测是否存在指定block\n\t     *\n\t     * @private\n\t     * @param {string} ns 名称空间\n\t     * @param {set} boolean 是否标记block已存在\n\t     * @return {boolean} 返加block标记\n\t     */\n\t    Ndoo.prototype._blockExist = function (ns, set) {\n\t        if (set === void 0) { set = false; }\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var name;\n\t        if (!nsmatch) {\n\t            nsmatch = [, '_default', ns];\n\t        }\n\t        ns = nsmatch[1], name = nsmatch[2];\n\t        if (set) {\n\t            return this._blockData._exist[\"block.\" + ns + \".\" + name] = true;\n\t        }\n\t        else {\n\t            return this._blockData._exist[\"block.\" + ns + \".\" + name];\n\t        }\n\t    };\n\t    /**\n\t     * 检测是否存在指定block\n\t     *\n\t     * @method\n\t     * @name hasBlock\n\t     * @memberof ndoo\n\t     * @param {string} ns 名称空间\n\t     * @return {boolean} 判断block是否存在\n\t     */\n\t    Ndoo.prototype.hasBlock = function (ns) {\n\t        return this._blockExist(ns);\n\t    };\n\t    /**\n\t     * 标识指定block\n\t     *\n\t     * @method\n\t     * @name setBlock\n\t     * @memberof ndoo\n\t     * @param {string} namespace 名称空间\n\t     * @return {boolean} 设置标识成功\n\t     */\n\t    Ndoo.prototype.setBlock = function (ns) {\n\t        return this._blockExist(ns, true);\n\t    };\n\t    /**\n\t     * 添加block实现\n\t     *\n\t     * @method\n\t     * @name block\n\t     * @memberof ndoo\n\t     * @param {string} namespace 名称空间\n\t     * @param {(object|function)} block 模块实现\n\t     * @return {(boolean|object|function)} 是否成功|标识本身\n\t     */\n\t    Ndoo.prototype.block = function (ns, block) {\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var name;\n\t        if (!nsmatch) {\n\t            nsmatch = [, 'default', ns];\n\t        }\n\t        ns = nsmatch[0], name = nsmatch[1];\n\t        if (arguments.length > 1) {\n\t            return this._block('block', ns, name, block);\n\t        }\n\t        else {\n\t            return this._block('block', ns, name);\n\t        }\n\t    };\n\t    /**\n\t     * 初始化模块\n\t     *\n\t     * @method\n\t     * @name initBlock\n\t     * @memberof ndoo\n\t     * @param {DOMElement} elem 初始化的元素\n\t     */\n\t    Ndoo.prototype.initBlock = function (elem) {\n\t        var _this = this;\n\t        var _a = this, _lib = _a._lib, router = _a.router;\n\t        var blockId = _lib.data(elem, 'nblockId');\n\t        blockId = blockId.split(/\\s*,\\s*|\\s+/);\n\t        var _call = function (blockId) {\n\t            router.parse(/^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/, blockId, function (ns, blockName, params) {\n\t                ns = ns.replace(/\\//g, '.');\n\t                var pkg = ns + \".\" + blockName;\n\t                if (_this.block(pkg)) {\n\t                    _this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n\t                }\n\t                else if (_this.hasBlock(pkg)) {\n\t                    _this.require([ns + \".\" + blockName], function () {\n\t                        _this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n\t                    }, _this._loader['block']);\n\t                }\n\t            });\n\t        };\n\t        _lib.each(blockId, function (id) {\n\t            var _self = _this;\n\t            _call.call(_self, id);\n\t        });\n\t    };\n\t    Ndoo.prototype._bindBlockEvent = function () {\n\t        var _this = this;\n\t        this.on('NBLOCK_LOADED', function (elem, ns, name, params) {\n\t            ns == null && (ns = '_default');\n\t            var block = _this.block(ns + \".\" + name);\n\t            if (block) {\n\t                if (_this._lib.isFunction(block.init)) {\n\t                    var call = function () {\n\t                        block.init(elem, params);\n\t                    };\n\t                    if (block.depend) {\n\t                        _this.require([].concat(block.depend), call, _this._loader['block']);\n\t                    }\n\t                    else {\n\t                        call();\n\t                    }\n\t                }\n\t                else if (_this._lib.isFunction(block)) {\n\t                    block(elem, params);\n\t                }\n\t            }\n\t        });\n\t        this.on('NBLOCK_INIT', function () {\n\t            var blockEl = _this._lib.querySelector('[data-nblock-id]');\n\t            if (!blockEl || !blockEl.length) {\n\t                return;\n\t            }\n\t            var blocks = [];\n\t            for (var _i = 0, blockEl_1 = blockEl; _i < blockEl_1.length; _i++) {\n\t                var el = blockEl_1[_i];\n\t                var auto = _this._lib.data(el, 'nblockAuto');\n\t                var level = parseInt(_this._lib.data(el, 'nblockLevel')) || 5;\n\t                blocks.push([level, auto, el]);\n\t            }\n\t            blocks = blocks.sort(function (block1, block2) { return block1[0] - block2[0]; });\n\t            for (var _a = 0, blocks_1 = blocks; _a < blocks_1.length; _a++) {\n\t                var item = blocks_1[_a];\n\t                var auto = item[1], block = item[2];\n\t                if (auto === undefined || auto.toString() != 'false') {\n\t                    _this.initBlock(block);\n\t                }\n\t            }\n\t        });\n\t    };\n\t    /**\n\t     * 添加/获取serivce\n\t     *\n\t     * @method\n\t     * @name service\n\t     * @memberof ndoo\n\t     * @param {string}   namespace 名称空间\n\t     * @param {variable} service 对象\n\t     * @example var _n = ndoo;\n\t     * _n.service('user', {\n\t     *   hasSignin: function(){\n\t     *     return false;\n\t     *   }\n\t     * });\n\t     * user = _n.service('user');\n\t     * console.log(user.hasSignin());\n\t     */\n\t    Ndoo.prototype.service = function (ns, service) {\n\t        var nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t        var name;\n\t        if (!nsmatch) {\n\t            nsmatch = [, '_default', ns];\n\t        }\n\t        ns = nsmatch[1], name = nsmatch[2];\n\t        if (arguments.length > 1) {\n\t            return this._block('service', ns, name, service);\n\t        }\n\t        else {\n\t            service = this._block('service', ns, name);\n\t            if (service && this._lib.isFunction(service.init)) {\n\t                return service.init();\n\t            }\n\t            else {\n\t                return service;\n\t            }\n\t        }\n\t    };\n\t    /**\n\t     * 路由函数\n\t     *\n\t     * @private\n\t     * @method\n\t     * @name dispatch\n\t     * @memberof ndoo\n\t     */\n\t    Ndoo.prototype.dispatch = function () {\n\t        var _this = this;\n\t        var _lib = this._lib;\n\t        var filterHaldner = function (type, controller, actionName, params) {\n\t            var data;\n\t            var _lib = _this._lib;\n\t            if (type === 'before') {\n\t                data = controller.before;\n\t            }\n\t            else if (type === 'after') {\n\t                data = controller.after;\n\t            }\n\t            if (!data) {\n\t                return;\n\t            }\n\t            var _data;\n\t            if (typeof data === 'object') {\n\t                _data = [].concat(data);\n\t            }\n\t            for (var _i = 0, _data_1 = _data; _i < _data_1.length; _i++) {\n\t                var dataItem = _data_1[_i];\n\t                var _filter = dataItem.filter;\n\t                if (!_lib.isArray(_filter)) {\n\t                    _filter = [].concat(_filter.split(/\\s*,\\s*|\\s+/));\n\t                }\n\t                var isRun = true;\n\t                if (dataItem.only) {\n\t                    var _only = dataItem.only;\n\t                    if (!_lib.isArray(_only)) {\n\t                        _only = [].concat(_only.split(/\\s*,\\s*|\\s+/));\n\t                    }\n\t                    if (_lib.indexOf(_only, actionName) < 0) {\n\t                        isRun = false;\n\t                    }\n\t                }\n\t                else if (dataItem.except) {\n\t                    var _except = dataItem.except;\n\t                    if (!_lib.isArray(_except)) {\n\t                        _except = [].concat(_except.split(/\\s*,\\s*|\\s+/));\n\t                    }\n\t                    if (_lib.indexOf(_except, actionName) > -1) {\n\t                        isRun = false;\n\t                    }\n\t                }\n\t                if (isRun) {\n\t                    for (var _a = 0, _filter_1 = _filter; _a < _filter_1.length; _a++) {\n\t                        var filter = _filter_1[_a];\n\t                        controller[filter + \"Filter\"](actionName, params);\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        this.on('NAPP_ACTION_BEFORE', function () {\n\t            var data = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                data[_i] = arguments[_i];\n\t            }\n\t            return filterHaldner.apply(null, ['before'].concat(data));\n\t        });\n\t        this.on('NAPP_ACTION_AFTER', function () {\n\t            var data = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                data[_i] = arguments[_i];\n\t            }\n\t            return filterHaldner.apply(null, ['after'].concat(data));\n\t        });\n\t        this.on('NAPP_LOADED', function (ns, appName, actionName, params) {\n\t            var appData;\n\t            var _self = _this;\n\t            if (ns) {\n\t                appData = _this.app(ns + \".\" + appName);\n\t            }\n\t            else {\n\t                appData = _this.app(appName);\n\t            }\n\t            if (!_lib.has(appData, actionName + \"Action\")\n\t                && _lib.has(appData, 'emptyAction')) {\n\t                actionName = '_empty';\n\t            }\n\t            var depend = [];\n\t            if (appData['depend']) {\n\t                depend = depend.concat(appData['depend']);\n\t            }\n\t            if (appData[actionName + \"Depend\"]) {\n\t                depend = depend.concat(appData[actionName + \"Depend\"]);\n\t            }\n\t            var filterPrefix = appName;\n\t            if (ns) {\n\t                filterPrefix = (ns + \".\" + appName).replace(/\\./g, '_');\n\t            }\n\t            filterPrefix = filterPrefix.toUpperCase();\n\t            var run = function () {\n\t                var args = [].slice.call(arguments, 0);\n\t                args.unshift(params);\n\t                if (actionName) {\n\t                    _self.trigger('NAPP_ACTION_BEFORE', appData, actionName, params);\n\t                    _self.trigger(\"NAPP_\" + filterPrefix + \"_ACTION_BEFORE\", appData, actionName, params);\n\t                    if (appData[actionName + \"Before\"]) {\n\t                        appData[actionName + \"Before\"].apply(appData, args);\n\t                    }\n\t                    if (appData[actionName + \"Action\"]) {\n\t                        appData[actionName + \"Action\"].apply(appData, args);\n\t                    }\n\t                    if (appData[actionName + \"After\"]) {\n\t                        appData[actionName + \"After\"].apply(appData, args);\n\t                    }\n\t                    _self.trigger(\"NAPP_\" + filterPrefix + \"_ACTION_AFTER\", appData, actionName, params);\n\t                    _self.trigger('NAPP_ACTION_AFTER', appData, actionName, params);\n\t                }\n\t                _self.trigger('STATUS:NBLOCK_INIT');\n\t            };\n\t            if (depend.length) {\n\t                _this.require(_lib.uniq(depend), run, _this._loader['app']);\n\t            }\n\t            else {\n\t                run();\n\t            }\n\t        });\n\t        this.on('PAGE_STATUS_ROUTING', function (data) {\n\t            _this.router.parse(/^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/, data, function (appName, actionName, params) {\n\t                var nsmatch = appName.match(/(.*?)(?:[/.]([^/.]+))$/);\n\t                var ns = '';\n\t                if (nsmatch) {\n\t                    ns = nsmatch[1], appName = nsmatch[2];\n\t                }\n\t                var pkg;\n\t                if (ns) {\n\t                    ns = ns.replace(/\\//g, '.');\n\t                    pkg = ns + \".\" + appName;\n\t                }\n\t                else {\n\t                    pkg = appName;\n\t                }\n\t                if (_this.app(pkg)) {\n\t                    _this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n\t                }\n\t                else if (_this.hasApp(pkg)) {\n\t                    _this.require([pkg], function () {\n\t                        this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n\t                    }, _this._loader['app']);\n\t                }\n\t                else {\n\t                    _this.trigger('STATUS:NBLOCK_INIT');\n\t                }\n\t            });\n\t        });\n\t    };\n\t    /**\n\t     * 触发页面状态\n\t     *\n\t     * @private\n\t     * @method\n\t     * @name triggerPageStatus\n\t     * @memberof ndoo\n\t     * @param depend {string|array} 赖数组\n\t     */\n\t    Ndoo.prototype.triggerPageStatus = function (depend) {\n\t        var _this = this;\n\t        var _lib = this._lib;\n\t        var call = function () {\n\t            _this.trigger('STATUS:PAGE_STATUS_FAST');\n\t            _lib.onready(function () {\n\t                _this.trigger('STATUS:PAGE_STATUS_DOMPREP');\n\t                _this.trigger('STATUS:PAGE_STATUS_DOM');\n\t                _this.trigger('STATUS:PAGE_STATUS_DOMORLOAD');\n\t            });\n\t            _lib.onload(function () {\n\t                _this.trigger('STATUS:PAGE_STATUS_LOAD');\n\t            });\n\t            _this.on('PAGE_STATUS_DOM', function () {\n\t                if (_this.pageId) {\n\t                    _this.trigger('STATUS:PAGE_STATUS_ROUTING', _this.pageId);\n\t                }\n\t            });\n\t        };\n\t        depend ? this.require([].concat(depend), call, this._loader['init']) : call();\n\t    };\n\t    /**\n\t     * 初始化页面\n\t     *\n\t     * @method\n\t     * @name init\n\t     * @memberof ndoo\n\t     * @param {string} id DOM的ID或指定ID\n\t     * @param {array} depend 依赖\n\t     * @example // ndoo alias _n\n\t     * _n.init('home/index')\n\t     * // set depend\n\t     * _n.init('home/index', ['library', 'common'])\n\t     */\n\t    Ndoo.prototype.init = function (id, depend) {\n\t        var _lib = this._lib;\n\t        if (_lib.isArray(id)) {\n\t            _a = ['', id], id = _a[0], depend = _a[1];\n\t        }\n\t        this.initPageId(id);\n\t        this.dispatch();\n\t        this.triggerPageStatus(depend);\n\t        return this;\n\t        var _a;\n\t    };\n\t    Ndoo.prototype._rebuildEvent = function () {\n\t        var _lib = this._lib;\n\t        var eventHandle = _lib.extend({\n\t            events: {},\n\t            listened: {}\n\t        }, _lib.Events);\n\t        this.event = _lib.extend(this.event, {\n\t            eventHandle: eventHandle,\n\t            on: function (eventName, callback) {\n\t                var eventHandle = this.eventHandle;\n\t                eventHandle.on(eventName, callback);\n\t                eventHandle.listened[eventName] = true;\n\t                if (_lib.has(eventHandle.events, \"STATUS:\" + eventName)) {\n\t                    callback.apply(eventHandle, eventHandle.events[\"STATUS:\" + eventName]);\n\t                }\n\t                if (_lib.has(eventHandle.events, eventName)) {\n\t                    for (var _i = 0, _a = eventHandle.events[eventName]; _i < _a.length; _i++) {\n\t                        var item = _a[_i];\n\t                        callback.apply(eventHandle, item);\n\t                    }\n\t                }\n\t            },\n\t            trigger: function (eventName, eventType, data) {\n\t                var eventHandle = this.eventHandle;\n\t                if (eventType === 'DEFAULT') {\n\t                    eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n\t                }\n\t                else if (eventType === 'DELAY') {\n\t                    if (_lib.has(eventHandle.listened, eventName)) {\n\t                        eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n\t                    }\n\t                    if (!_lib.has(eventHandle.events, eventName)) {\n\t                        eventHandle.events[eventName] = [];\n\t                    }\n\t                    eventHandle.events[eventName].push(data);\n\t                }\n\t                else if (eventType === 'STATUS') {\n\t                    if (!_lib.has(eventHandle.events, eventType + \":\" + eventName)) {\n\t                        eventHandle.events[eventType + \":\" + eventName] = data;\n\t                        if (_lib.has(eventHandle.listened, eventName)) {\n\t                            eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n\t                        }\n\t                    }\n\t                }\n\t            },\n\t            off: function (eventName) {\n\t                var eventHandle = this.eventHandle;\n\t                eventHandle.off(eventName);\n\t                delete eventHandle.listened[eventName];\n\t                delete eventHandle.events[eventName];\n\t            },\n\t            init: function () {\n\t                var _a = this, inited = _a.inited, _temp = _a._temp, TYPE_ON = _a.TYPE_ON, TYPE_TRIGGER = _a.TYPE_TRIGGER;\n\t                if (!inited && _temp.length) {\n\t                    for (var _i = 0, _temp_1 = _temp; _i < _temp_1.length; _i++) {\n\t                        var item = _temp_1[_i];\n\t                        if (item.type === TYPE_ON) {\n\t                            this.on(item.eventName, item.callback);\n\t                        }\n\t                        else if (item.type === TYPE_TRIGGER) {\n\t                            this.trigger(item.eventName, item.eventTYpe, item.data);\n\t                        }\n\t                    }\n\t                    inited = true;\n\t                }\n\t            }\n\t        });\n\t    };\n\t    return Ndoo;\n\t}(prep_1.Prep));\n\texports.Ndoo = Ndoo;\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar api_1 = __webpack_require__(4);\n\tvar basic_1 = __webpack_require__(5);\n\tvar prepData_1 = __webpack_require__(6);\n\tvar prepData = prepData_1.getPrepData();\n\t/**\n\t * ndoojs 全局名称空间，短名称N\n\t *\n\t * @namespace ndoo\n\t */\n\tvar Prep = (function (_super) {\n\t    __extends(Prep, _super);\n\t    function Prep() {\n\t        var _this = _super.call(this) || this;\n\t        _this.event = basic_1.EventBasic;\n\t        /**\n\t         * 变量存储名称空间\n\t         *\n\t         * @namespace\n\t         * @name vars\n\t         * @alias _vars\n\t         * @memberof ndoo\n\t         * @type {object}\n\t         * @example // alias _vars\n\t         * var _vars = ndoo.vars;\n\t         * vars.bar = 'bar';\n\t         */\n\t        _this.vars = {};\n\t        /**\n\t         * 函数存储名称空间\n\t         *\n\t         * @namespace\n\t         * @name func\n\t         * @memberof ndoo\n\t         * @type {object}\n\t         * @example // alias _func\n\t         * var _func = ndoo.func;\n\t         * _func.foo = function() {\n\t         *   console.log('foo');\n\t         * }\n\t         */\n\t        _this.func = {};\n\t        /**\n\t         * 依赖库存储空间\n\t         */\n\t        _this._lib = {};\n\t        if (prepData) {\n\t            _this.vars = prepData.vars;\n\t            _this.func = prepData.func;\n\t        }\n\t        return _this;\n\t    }\n\t    return Prep;\n\t}(api_1.EventApi));\n\texports.Prep = Prep;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar EventApi = (function () {\n\t    function EventApi() {\n\t    }\n\t    /**\n\t     * global on\n\t     *\n\t     * @method\n\t     * @name on\n\t     * @memberof ndoo\n\t     * @param {string} eventName 事件名称\n\t     * @param {function} callback 事件回调\n\t     * @example // ndoo alias _n\n\t     * var _n = ndoo;\n\t     * _n.on('testEvent', function(data, data2){\n\t     *   console.log(data);\n\t     *   console.log(data2);\n\t     * });\n\t     * _n.trigger('testEvent', 'testEvent', 'kkk');\n\t     */\n\t    EventApi.prototype.on = function (eventName, callback) {\n\t        eventName = eventName.split(/\\s*,\\s*|\\s+/);\n\t        for (var _i = 0, _a = eventName; _i < _a.length; _i++) {\n\t            var e = _a[_i];\n\t            this.event.on(e, callback);\n\t        }\n\t    };\n\t    /**\n\t     * global trigger\n\t     *\n\t     * @method\n\t     * @name trigger\n\t     * @memberof ndoo\n\t     * @param {string} eventName 事件名称\n\t     * @param {variable} data 数据，可以是多个\n\t     */\n\t    EventApi.prototype.trigger = function (eventName) {\n\t        var data = [];\n\t        for (var _i = 1; _i < arguments.length; _i++) {\n\t            data[_i - 1] = arguments[_i];\n\t        }\n\t        var _index = eventName.indexOf(':');\n\t        var type = eventName.substring(0, _index++) || 'DEFAULT';\n\t        var e = eventName.substring(_index);\n\t        this.event.trigger(e, type, data);\n\t    };\n\t    /**\n\t     * global off\n\t     *\n\t     * @method\n\t     * @name off\n\t     * @memberof ndoo\n\t     * @param {string} eventName 事件名称\n\t     */\n\t    EventApi.prototype.off = function (eventName) {\n\t        eventName = eventName.split(/\\s*,\\s*|\\s+/);\n\t        for (var _i = 0, _a = eventName; _i < _a.length; _i++) {\n\t            var e = _a[_i];\n\t            this.event.off(e);\n\t        }\n\t    };\n\t    return EventApi;\n\t}());\n\texports.EventApi = EventApi;\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar prepData_1 = __webpack_require__(6);\n\tvar prepData = prepData_1.getPrepData();\n\t/**\n\t * 事件模块\n\t *\n\t * @namespace\n\t * @name event\n\t * @memberof ndoo\n\t * @param {string} name 事件名称\n\t * @param {string} type 事件类型\n\t */\n\tvar EventBasic = (function () {\n\t    function EventBasic(name, type) {\n\t        return \"#\" + name + \":#\" + type;\n\t    }\n\t    /**\n\t     * on api\n\t     *\n\t     * @method\n\t     * @name on\n\t     * @memberof ndoo.event\n\t     * @param {string} eventName 事件名称\n\t     * @param {function} callback 回调函数\n\t     */\n\t    EventBasic.on = function (eventName, callback) {\n\t        this._temp.push({\n\t            type: this.TYPE_ON,\n\t            eventName: eventName, callback: callback\n\t        });\n\t    };\n\t    /**\n\t     * trigger api\n\t     *\n\t     * @method\n\t     * @name trigger\n\t     * @memberof ndoo.event\n\t     * @param eventName {string} 事件名称\n\t     * @param eventType {string} 事件类型\n\t     * @param data {variable} 数据类型\n\t     */\n\t    EventBasic.trigger = function (eventName, eventType, data) {\n\t        this._temp.push({\n\t            type: this.TYPE_TRIGGER,\n\t            eventName: eventName, eventType: eventType, data: data\n\t        });\n\t    };\n\t    /**\n\t     * off api\n\t     *\n\t     * @method\n\t     * @name off\n\t     * @memberof ndoo.event\n\t     * @param eventName {string}\n\t     */\n\t    EventBasic.off = function (eventName) { };\n\t    EventBasic.init = function () { };\n\t    return EventBasic;\n\t}());\n\t/**\n\t * 暂存数据类型\n\t *\n\t * @name TYPE_ON\n\t * @memberof ndoo.event\n\t * @type {number}\n\t */\n\tEventBasic.TYPE_ON = 1;\n\t/**\n\t * 暂存数据类型\n\t *\n\t * @name TYPE_TRIGGER\n\t * @memberof ndoo.event\n\t * @type {number}\n\t */\n\tEventBasic.TYPE_TRIGGER = 2;\n\t/**\n\t * init token\n\t *\n\t * @name inited\n\t * @memberof ndoo.event\n\t * @type {boolean}\n\t */\n\tEventBasic.inited = false;\n\t/**\n\t * event stack\n\t *\n\t * @private\n\t * @name _temp\n\t * @memberof ndoo.event\n\t * @type {array}\n\t */\n\tEventBasic._temp = prepData ? prepData.eventData : [];\n\texports.EventBasic = EventBasic;\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\texports.getPrepData = function () {\n\t    if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n\t        return window['ndoo_prep_data'];\n\t    }\n\t    return false;\n\t};\n\texports.setPrepData = function () {\n\t    var _self = {};\n\t    if (typeof window != 'undefined') {\n\t        _self = window;\n\t    }\n\t    if (!_self.ndoo_prep_data) {\n\t        _self.ndoo_prep_data = {\n\t            eventData: [],\n\t            func: {},\n\t            vars: {}\n\t        };\n\t    }\n\t};\n\texports.removePrepData = function () {\n\t    if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n\t        delete window['ndoo_prep_data'];\n\t    }\n\t};\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t/**\n\t * 变量存储\n\t *\n\t * @method\n\t * @name storage\n\t * @memberof ndoo\n\t * @param {string} key 键名\n\t * @param {variable} value 值\n\t * @param {const} option 选项，覆盖或删除\n\t * @example // alias _stor\n\t * var _stor = ndoo.storage;\n\t * // set abc vlaue 1\n\t * _stor('abc', 1); // 1\n\t * // set abc value 2 failed\n\t * _stor('abc', 2); // false\n\t * // set abc value 2\n\t * _stor('abc', 2, _stor.REWRITE); // 2\n\t * // delete abc\n\t * _stor('abc', null, _stor.DESTROY); // true\n\t */\n\tvar Storage = (function () {\n\t    function Storage(key, value, option) {\n\t        var _self = Storage;\n\t        var destroy = option & _self.DESTROY;\n\t        var rewrite = option & _self.REWRITE;\n\t        var data = _self._data;\n\t        if (value === undefined) {\n\t            return data[key];\n\t        }\n\t        if (destroy) {\n\t            delete data[key];\n\t            return true;\n\t        }\n\t        if (!rewrite && _self._lib.has(data, key)) {\n\t            return false;\n\t        }\n\t        return data[key] = value;\n\t    }\n\t    return Storage;\n\t}());\n\tStorage._data = {};\n\t/**\n\t * storage重写常量\n\t *\n\t * @memberof ndoo.storage\n\t */\n\tStorage.REWRITE = 1;\n\t/**\n\t * storage删除常量\n\t *\n\t * @memberof ndoo.storage\n\t */\n\tStorage.DESTROY = 2;\n\texports.Storage = Storage;\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t/**\n\t * 内置路由通过正则配匹各部件\n\t *\n\t * @private\n\t * @namespace\n\t * @memberof ndoo\n\t * @type {object}\n\t */\n\tvar Router = (function () {\n\t    function Router() {\n\t    }\n\t    /**\n\t     * 路由解析方法\n\t     *\n\t     * @private\n\t     * @method\n\t     * @memberof ndoo.router\n\t     * @param route {RegExp} 路由正则\n\t     * @param url {string url路径\n\t     * @param callback {Function} 回调函数\n\t     */\n\t    Router.parse = function (route, url, callback) {\n\t        var routeMatch = route.exec(url);\n\t        if (routeMatch != null) {\n\t            callback.apply(null, routeMatch.slice(1));\n\t        }\n\t    };\n\t    return Router;\n\t}());\n\texports.Router = Router;\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar _ = __webpack_require__(10);\n\tvar depend = __webpack_require__(11);\n\tvar event_1 = __webpack_require__(14);\n\texports._lib = _.extend({ Events: event_1.Events }, depend, _);\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t/// <references src=\"../declare.d.ts\" />\n\tvar jquery = __webpack_require__(12);\n\tvar zepto = __webpack_require__(13);\n\tvar $ = jquery || zepto;\n\tvar depend = {};\n\tif ($) {\n\t    depend.onready = function (callback) {\n\t        return $(callback);\n\t    };\n\t    depend.onload = function (callback) {\n\t        return $(window).on('load', callback);\n\t    };\n\t    depend.querySelector = function (selector) {\n\t        return $(selector).get();\n\t    };\n\t    depend.data = function (elem, key, value) {\n\t        if (arguments.length === 2) {\n\t            return $(elem).data(key);\n\t        }\n\t        else if (arguments.length === 3) {\n\t            return $(elem).data(key, value);\n\t        }\n\t    };\n\t}\n\telse {\n\t    depend.onready = function (callback) {\n\t        return document.addEventListener('DOMContentLoaded', callback, false);\n\t    };\n\t    depend.onload = function (callback) {\n\t        return addEventListener('load', callback, false);\n\t    };\n\t    depend.querySelector = function (selector) {\n\t        return document.querySelectorAll(selector);\n\t    };\n\t    depend.data = function (elem, key, value) {\n\t        if (!elem.dataset) {\n\t            key = key.replace(/([A-Z])/g, function (char) { return '-' + char.toLocaleLowerCase(); });\n\t        }\n\t        if (arguments.length === 2) {\n\t            if (elem.dataset) {\n\t                return elem.dataset[key];\n\t            }\n\t            else {\n\t                return elem.getAttribute(key);\n\t            }\n\t        }\n\t        else if (arguments.length === 3) {\n\t            if (elem.dataset) {\n\t                elem.dataset[key] = value;\n\t            }\n\t            else {\n\t                elem.setAttribute(key, value);\n\t            }\n\t        }\n\t    };\n\t}\n\texports.onready = depend.onready, exports.onload = depend.onload, exports.querySelector = depend.querySelector, exports.data = depend.data;\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n/***/ },\n/* 13 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_13__;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar _ = __webpack_require__(10);\n\tvar Backbone = __webpack_require__(15);\n\tvar Events = {};\n\texports.Events = Events;\n\tif (Backbone) {\n\t    exports.Events = Events = Backbone.Events;\n\t}\n\telse {\n\t    // Backbone.Events\n\t    // ---------------\n\t    // A module that can be mixed in to *any object* in order to provide it with\n\t    // a custom event channel. You may bind a callback to an event with 'on' or\n\t    // remove with 'off'; 'trigger'-ing an event fires all callbacks in\n\t    // succession.\n\t    //\n\t    //     var object = {};\n\t    //     _.extend(object, Backbone.Events);\n\t    //     object.on('expand', function(){ alert('expanded'); });\n\t    //     object.trigger('expand');\n\t    //\n\t    // var Events: any = {};\n\t    // Regular expression used to split event strings.\n\t    var eventSplitter = /\\s+/;\n\t    // Iterates over the standard 'event, callback' (as well as the fancy multiple\n\t    // space-separated events '\"change blur\", callback' and jQuery-style event\n\t    // maps '{event: callback}').\n\t    var eventsApi = function (iteratee, events, name, callback, opts) {\n\t        var i = 0, names;\n\t        if (name && typeof name === 'object') {\n\t            // Handle event maps.\n\t            if (callback !== void 0 && 'context' in opts && opts.context === void 0)\n\t                opts.context = callback;\n\t            for (names = _.keys(name); i < names.length; i++) {\n\t                events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\n\t            }\n\t        }\n\t        else if (name && eventSplitter.test(name)) {\n\t            // Handle space separated event names by delegating them individually.\n\t            for (names = name.split(eventSplitter); i < names.length; i++) {\n\t                events = iteratee(events, names[i], callback, opts);\n\t            }\n\t        }\n\t        else {\n\t            // Finally, standard events.\n\t            events = iteratee(events, name, callback, opts);\n\t        }\n\t        return events;\n\t    };\n\t    // Bind an event to a 'callback' function. Passing '\"all\"' will bind\n\t    // the callback to all events fired.\n\t    Events.on = function (name, callback, context) {\n\t        return internalOn(this, name, callback, context);\n\t    };\n\t    // Guard the 'listening' argument from the public API.\n\t    var internalOn = function (obj, name, callback, context, listening) {\n\t        obj._events = eventsApi(onApi, obj._events || {}, name, callback, {\n\t            context: context,\n\t            ctx: obj,\n\t            listening: listening\n\t        });\n\t        if (listening) {\n\t            var listeners = obj._listeners || (obj._listeners = {});\n\t            listeners[listening.id] = listening;\n\t        }\n\t        return obj;\n\t    };\n\t    // Inversion-of-control versions of 'on'. Tell *this* object to listen to\n\t    // an event in another object... keeping track of what it's listening to\n\t    // for easier unbinding later.\n\t    Events.listenTo = function (obj, name, callback) {\n\t        if (!obj)\n\t            return this;\n\t        var id = obj._listenId || (obj._listenId = _.uniqueId('l'));\n\t        var listeningTo = this._listeningTo || (this._listeningTo = {});\n\t        var listening = listeningTo[id];\n\t        // This object is not listening to any other events on 'obj' yet.\n\t        // Setup the necessary references to track the listening callbacks.\n\t        if (!listening) {\n\t            var thisId = this._listenId || (this._listenId = _.uniqueId('l'));\n\t            listening = listeningTo[id] = { obj: obj, objId: id, id: thisId, listeningTo: listeningTo, count: 0 };\n\t        }\n\t        // Bind callbacks on obj, and keep track of them on listening.\n\t        internalOn(obj, name, callback, this, listening);\n\t        return this;\n\t    };\n\t    // The reducing API that adds a callback to the 'events' object.\n\t    var onApi = function (events, name, callback, options) {\n\t        if (callback) {\n\t            var handlers = events[name] || (events[name] = []);\n\t            var context = options.context, ctx = options.ctx, listening = options.listening;\n\t            if (listening)\n\t                listening.count++;\n\t            handlers.push({ callback: callback, context: context, ctx: context || ctx, listening: listening });\n\t        }\n\t        return events;\n\t    };\n\t    // Remove one or many callbacks. If 'context' is null, removes all\n\t    // callbacks with that function. If 'callback' is null, removes all\n\t    // callbacks for the event. If 'name' is null, removes all bound\n\t    // callbacks for all events.\n\t    Events.off = function (name, callback, context) {\n\t        if (!this._events)\n\t            return this;\n\t        this._events = eventsApi(offApi, this._events, name, callback, {\n\t            context: context,\n\t            listeners: this._listeners\n\t        });\n\t        return this;\n\t    };\n\t    // Tell this object to stop listening to either specific events ... or\n\t    // to every object it's currently listening to.\n\t    Events.stopListening = function (obj, name, callback) {\n\t        var listeningTo = this._listeningTo;\n\t        if (!listeningTo)\n\t            return this;\n\t        var ids = obj ? [obj._listenId] : _.keys(listeningTo);\n\t        for (var i = 0; i < ids.length; i++) {\n\t            var listening = listeningTo[ids[i]];\n\t            // If listening doesn't exist, this object is not currently\n\t            // listening to obj. Break out early.\n\t            if (!listening)\n\t                break;\n\t            listening.obj.off(name, callback, this);\n\t        }\n\t        if (_.isEmpty(listeningTo))\n\t            this._listeningTo = void 0;\n\t        return this;\n\t    };\n\t    // The reducing API that removes a callback from the 'events' object.\n\t    var offApi = function (events, name, callback, options) {\n\t        if (!events)\n\t            return;\n\t        var i = 0, listening;\n\t        var context = options.context, listeners = options.listeners;\n\t        // Delete all events listeners and \"drop\" events.\n\t        if (!name && !callback && !context) {\n\t            var ids = _.keys(listeners);\n\t            for (; i < ids.length; i++) {\n\t                listening = listeners[ids[i]];\n\t                delete listeners[listening.id];\n\t                delete listening.listeningTo[listening.objId];\n\t            }\n\t            return;\n\t        }\n\t        var names = name ? [name] : _.keys(events);\n\t        for (; i < names.length; i++) {\n\t            name = names[i];\n\t            var handlers = events[name];\n\t            // Bail out if there are no events stored.\n\t            if (!handlers)\n\t                break;\n\t            // Replace events if there are any remaining.  Otherwise, clean up.\n\t            var remaining = [];\n\t            for (var j = 0; j < handlers.length; j++) {\n\t                var handler = handlers[j];\n\t                if (callback && callback !== handler.callback &&\n\t                    callback !== handler.callback._callback ||\n\t                    context && context !== handler.context) {\n\t                    remaining.push(handler);\n\t                }\n\t                else {\n\t                    listening = handler.listening;\n\t                    if (listening && --listening.count === 0) {\n\t                        delete listeners[listening.id];\n\t                        delete listening.listeningTo[listening.objId];\n\t                    }\n\t                }\n\t            }\n\t            // Update tail event if the list has any events.  Otherwise, clean up.\n\t            if (remaining.length) {\n\t                events[name] = remaining;\n\t            }\n\t            else {\n\t                delete events[name];\n\t            }\n\t        }\n\t        if (_.size(events))\n\t            return events;\n\t    };\n\t    // Bind an event to only be triggered a single time. After the first time\n\t    // the callback is invoked, its listener will be removed. If multiple events\n\t    // are passed in using the space-separated syntax, the handler will fire\n\t    // once for each event, not once for a combination of all events.\n\t    Events.once = function (name, callback, context) {\n\t        // Map the event into a '{event: once}' object.\n\t        var events = eventsApi(onceMap, {}, name, callback, _.bind(this.off, this));\n\t        return this.on(events, void 0, context);\n\t    };\n\t    // Inversion-of-control versions of 'once'.\n\t    Events.listenToOnce = function (obj, name, callback) {\n\t        // Map the event into a '{event: once}' object.\n\t        var events = eventsApi(onceMap, {}, name, callback, _.bind(this.stopListening, this, obj));\n\t        return this.listenTo(obj, events);\n\t    };\n\t    // Reduces the event callbacks into a map of '{event: onceWrapper}'.\n\t    // 'offer' unbinds the 'onceWrapper' after it has been called.\n\t    var onceMap = function (map, name, callback, offer) {\n\t        if (callback) {\n\t            var once = map[name] = _.once(function () {\n\t                offer(name, once);\n\t                callback.apply(this, arguments);\n\t            });\n\t            once._callback = callback;\n\t        }\n\t        return map;\n\t    };\n\t    // Trigger one or many events, firing all bound callbacks. Callbacks are\n\t    // passed the same arguments as 'trigger' is, apart from the event name\n\t    // (unless you're listening on '\"all\"', which will cause your callback to\n\t    // receive the true name of the event as the first argument).\n\t    Events.trigger = function (name) {\n\t        if (!this._events)\n\t            return this;\n\t        var length = Math.max(0, arguments.length - 1);\n\t        var args = Array(length);\n\t        for (var i = 0; i < length; i++)\n\t            args[i] = arguments[i + 1];\n\t        eventsApi(triggerApi, this._events, name, void 0, args);\n\t        return this;\n\t    };\n\t    // Handles triggering the appropriate event callbacks.\n\t    var triggerApi = function (objEvents, name, cb, args) {\n\t        if (objEvents) {\n\t            var events = objEvents[name];\n\t            var allEvents = objEvents.all;\n\t            if (events && allEvents)\n\t                allEvents = allEvents.slice();\n\t            if (events)\n\t                triggerEvents(events, args);\n\t            if (allEvents)\n\t                triggerEvents(allEvents, [name].concat(args));\n\t        }\n\t        return objEvents;\n\t    };\n\t    // A difficult-to-believe, but optimized internal dispatch function for\n\t    // triggering events. Tries to keep the usual cases speedy (most internal\n\t    // Backbone events have 3 arguments).\n\t    var triggerEvents = function (events, args) {\n\t        var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n\t        switch (args.length) {\n\t            case 0:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx);\n\t                return;\n\t            case 1:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx, a1);\n\t                return;\n\t            case 2:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx, a1, a2);\n\t                return;\n\t            case 3:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.call(ev.ctx, a1, a2, a3);\n\t                return;\n\t            default:\n\t                while (++i < l)\n\t                    (ev = events[i]).callback.apply(ev.ctx, args);\n\t                return;\n\t        }\n\t    };\n\t    // Aliases for backwards compatibility.\n\t    Events.bind = Events.on;\n\t    Events.unbind = Events.off;\n\t}\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_15__;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar RegType;\n\t(function (RegType) {\n\t    RegType[RegType[\"App\"] = 0] = \"App\";\n\t    RegType[RegType[\"Block\"] = 1] = \"Block\";\n\t    RegType[RegType[\"Service\"] = 2] = \"Service\";\n\t})(RegType = exports.RegType || (exports.RegType = {}));\n\texports.getComponent = function (ndoo) {\n\t    /**\n\t     * ndoo组件注册\n\t     */\n\t    return function (path, type, isStatic) {\n\t        if (isStatic === void 0) { isStatic = true; }\n\t        return function (component) {\n\t            // 是否静态类型\n\t            var instance = component;\n\t            if (!isStatic) {\n\t                instance = new component();\n\t            }\n\t            // 注册类型\n\t            var method = '';\n\t            switch (type) {\n\t                case RegType.App:\n\t                    method = 'app';\n\t                    break;\n\t                case RegType.Block:\n\t                    method = 'block';\n\t                    break;\n\t                case RegType.Service:\n\t                    method = 'service';\n\t                    break;\n\t            }\n\t            // 注册\n\t            method && ndoo[method](path, instance);\n\t        };\n\t    };\n\t};\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// dist/ndoo.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9c669bdd9cda0e9cb705","import { Ndoo } from './src/ndoo';\n\nexport = new Ndoo();\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/ndoo.ts","import { Prep } from './prep';\nimport { Storage } from './storage';\nimport { Router } from './router';\nimport { _lib as lib } from './lib';\nimport { getPrepData, removePrepData } from './prepData';\nimport { RegType, getComponent } from './component';\n\nlet prepData = getPrepData();\n\nexport class Ndoo extends Prep {\n  public _lib = lib;\n  /**\n   * page id\n   *\n   * @name pageId\n   * @memberof ndoo\n   * @type {string}\n   */\n  public pageId: string = '';\n  /**\n   * initPageId 初始化 pageId\n   *\n   * @private\n   * @name initPageId\n   * @memberof ndoo\n   */\n  public initPageId(id: string) {\n    if (this.pageId) {\n      return;\n    }\n    if (typeof document != 'undefined') {\n      let el = document.getElementById(id || 'scriptArea');\n      if (el) {\n        this.pageId = el.getAttribute('data-page-id') || '';\n      }\n      if (!this.pageId && id) {\n        this.pageId = id;\n      }\n    }\n  }\n  /**\n   * 内部_pk主键\n   * \n   * @private\n   * @name _pk\n   * @memberof ndoo\n   */\n  private _pk: number = +new Date();\n  /**\n   * 获取唯一key\n   *\n   * @method\n   * @name getPk\n   * @memberof ndoo\n   * @param prefix {string} 前缀\n   * @return {string} 键名\n   */\n  public getPk(prefix: string = '') {\n    return `${prefix}${++this._pk}`;\n  }\n  public storage: typeof Storage = Storage;\n  public router: typeof Router = Router;\n  private _loader = {\n    app: 'do',\n    block: 'do',\n    init: 'do',\n    appLoader: null,\n    blockLoader: null,\n    initLoader: null,\n    doLoader: function(depend: any[], callback: Function) {\n      Do.apply(null, depend.concat(callback));\n    },\n    seajsLoader: function(depend: any[], callback: Function) {\n      seajs.use(depend, callback);\n    }\n  };\n  /**\n   * 设置加载器\n   * \n   * @method\n   * @name setLoader\n   * @memberof ndoo\n   * @param type {string} 加载器类型\n   * @param loader {Function} 加载器回调函数\n   */\n  public setLoader(type: string, loader: Function) {\n    this._loader[type] = `${type}Loader`;\n    this._loader[`${type}Loader`] = loader;\n  }\n  /**\n   * 依赖加载方法\n   * \n   * @method\n   * @name require\n   * @memberof ndoo\n   * @param depend {array} 依赖\n   * @param callback {Function} 架设函数\n   * @param type {string} 加载器类型 app/block/service\n   */\n  public require(depend: any[], callback: Function, type: string): void {\n    type = type.toLowerCase();\n    if (this._loader[`${type}Loader`]) {\n      this[type](depend, callback);\n    }\n    else {\n      throw new Error('require load is not define');\n    }\n  }\n  public _blockData = {\n    _block: {},\n    _app: {},\n    _service: {},\n    _exist: {}\n  }\n  public _block(base: string, ns: string, name: string, block?: any) {\n    let data: any;\n    let nsArr: string[];\n    if (base == 'block' || base == 'app' || base == 'service') {\n      data = this._blockData[`_${base}`];\n    }\n    else {\n      return false;\n    }\n\n    if (ns) {\n      nsArr = ns.replace(/^[/.]|[/.]$/g, '').split(/[/.]/);\n    }\n    else {\n      nsArr = [];\n    }\n\n    let temp = data;\n    let result: any;\n    let success: boolean;\n    if (block || arguments.length > 3) {\n      for (let ns of nsArr) {\n        temp = temp[ns] || (temp[ns] = {});\n      }\n      // app/block只允许真值\n      if (block && (base === 'app' || base === 'block')) {\n        if (typeof block === 'object') {\n          if (base === 'app' && temp[name]) {\n            result = this._lib.defaults(temp[name], block);\n          }\n          else {\n            result = temp[name] = block;\n          }\n        }\n        else if (typeof block === 'function') {\n          result = temp[name] = block;\n        }\n        else {\n          result = false;\n        }\n      }\n      else if (base == 'service') {\n        result = temp[name] = block;\n        success = true;\n      }\n      else {\n        result = false;\n      }\n\n      if (result || success) {\n        if (ns) {\n          this._blockData._exist[`${base}.${ns}.${name}`] = true;\n        }\n        else {\n          this._blockData._exist[`${base}.${name}`] = true;\n        }\n      }\n\n      return result;\n    }\n    else {\n      for (let ns of nsArr) {\n        if (!this._lib.has(temp, ns)) {\n          return undefined;\n        }\n        temp = temp[ns];\n      }\n      return temp[name];\n    }\n  }\n  /**\n   * 检测是否存在指定app\n   *\n   * @method\n   * @name hasApp\n   * @memberof ndoo\n   * @param {string} namespace 名称空间\n   * @return {boolean} 是否在存指定的app\n   */\n  hasApp(ns: string) {\n    return this._blockData._exist[`app.${ns}`]\n  }\n  /**\n   * 标识指定app已存在\n   *\n   * @method\n   * @name setApp\n   * @memberof ndoo\n   * @param {string} namespace 名称空间\n   */\n  setApp(ns: string) {\n    return this._blockData._exist[`app.${ns}`] = true;\n  }\n  /**\n   * 添加app实现\n   *\n   * @method\n   * @name app\n   * @memberof ndoo\n   * @param {string} namespace 名称空间\n   * @param {object} controller 控制器\n   */\n  app(ns: string, app?: any) {\n    let nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let appName: string;\n    if (!nsmatch) {\n      nsmatch = [, null, ns]\n    }\n    [, ns, appName] = nsmatch;\n\n    if (arguments.length > 1) {\n      return this._block('app', ns, appName, app);\n    }\n    else {\n      return this._block('app', ns, appName);\n    }\n  }\n  /**\n   * 检测是否存在指定block\n   *\n   * @private\n   * @param {string} ns 名称空间\n   * @param {set} boolean 是否标记block已存在\n   * @return {boolean} 返加block标记\n   */\n  _blockExist(ns: string, set: boolean = false) {\n    let nsmatch: string[] = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let name: string;\n    if (!nsmatch) {\n      nsmatch = [, '_default', ns];\n\n    }\n    [, ns, name] = nsmatch;\n    if (set) {\n      return this._blockData._exist[`block.${ns}.${name}`] = true;\n    }\n    else {\n      return this._blockData._exist[`block.${ns}.${name}`]\n    }\n  }\n  /**\n   * 检测是否存在指定block\n   *\n   * @method\n   * @name hasBlock\n   * @memberof ndoo\n   * @param {string} ns 名称空间\n   * @return {boolean} 判断block是否存在\n   */\n  hasBlock(ns: string) {\n    return this._blockExist(ns);\n  }\n  /**\n   * 标识指定block\n   *\n   * @method\n   * @name setBlock\n   * @memberof ndoo\n   * @param {string} namespace 名称空间\n   * @return {boolean} 设置标识成功\n   */\n  setBlock(ns: string) {\n    return this._blockExist(ns, true);\n  }\n  /**\n   * 添加block实现\n   *\n   * @method\n   * @name block\n   * @memberof ndoo\n   * @param {string} namespace 名称空间\n   * @param {(object|function)} block 模块实现\n   * @return {(boolean|object|function)} 是否成功|标识本身\n   */\n  block(ns: string, block?: any) {\n    let nsmatch: string[] = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let name: string;\n    if (!nsmatch) {\n      nsmatch = [, 'default', ns];\n    }\n    [ns, name] = nsmatch;\n    if (arguments.length > 1) {\n      return this._block('block', ns, name, block);\n    }\n    else {\n      return this._block('block', ns, name);\n    }\n  }\n  /**\n   * 初始化模块\n   *\n   * @method\n   * @name initBlock\n   * @memberof ndoo\n   * @param {DOMElement} elem 初始化的元素\n   */\n  initBlock(elem: HTMLElement) {\n    let {_lib, router} = this;\n    let blockId: string | string[] = _lib.data(elem, 'nblockId');\n    blockId = (<string>blockId).split(/\\s*,\\s*|\\s+/);\n\n    let _call = (blockId: string) => {\n      router.parse(\n        /^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/,\n        blockId, (ns: string, blockName: string, params: string) => {\n          ns = ns.replace(/\\//g, '.');\n          let pkg: string = `${ns}.${blockName}`;\n          if (this.block(pkg)) {\n            this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n          }\n          else if (this.hasBlock(pkg)) {\n            this.require([`${ns}.${blockName}`], () => {\n              this.trigger('NBLOCK_LOADED', elem, ns, blockName, params);\n            }, this._loader['block']);\n          }\n        });\n    }\n    _lib.each(blockId, (id: string) => {\n      let _self = this;\n      _call.call(_self, id);\n    });\n  }\n  private _bindBlockEvent() {\n    this.on('NBLOCK_LOADED', (elem, ns, name, params) => {\n      ns == null && (ns = '_default');\n      let block = this.block(`${ns}.${name}`);\n      if (block) {\n        if (this._lib.isFunction(block.init)) {\n          let call = () => {\n            block.init(elem, params);\n          }\n\n          if (block.depend) {\n            this.require([].concat(block.depend), call, this._loader['block']);\n          }\n          else {\n            call();\n          }\n        }\n        else if (this._lib.isFunction(block)) {\n          block(elem, params);\n        }\n      }\n    });\n    this.on('NBLOCK_INIT', () => {\n      let blockEl = this._lib.querySelector('[data-nblock-id]');\n      if (!blockEl || !blockEl.length) {\n        return;\n      }\n      let blocks:any[] = [];\n      for (let el of blockEl) {\n        let auto = this._lib.data(el, 'nblockAuto');\n        let level = parseInt(this._lib.data(el, 'nblockLevel')) || 5;\n        blocks.push([level, auto, el]);\n      }\n      blocks = blocks.sort((block1: any, block2: any) => block1[0] - block2[0]);\n      for (let item of blocks) {\n        let [, auto, block] = item;\n        if (auto === undefined || auto.toString() != 'false') {\n          this.initBlock(block);\n        }\n      }\n    });\n  }\n  /**\n   * 添加/获取serivce\n   *\n   * @method\n   * @name service\n   * @memberof ndoo\n   * @param {string}   namespace 名称空间\n   * @param {variable} service 对象\n   * @example var _n = ndoo;\n   * _n.service('user', {\n   *   hasSignin: function(){\n   *     return false;\n   *   }\n   * });\n   * user = _n.service('user');\n   * console.log(user.hasSignin());\n   */\n  service(ns: string, service: any) {\n    let nsmatch = ns.match(/(.*?)(?:[/.]([^/.]+))$/);\n    let name: string;\n\n    if (!nsmatch) {\n      nsmatch = [, '_default', ns];\n    }\n    [, ns, name] = nsmatch;\n\n    if (arguments.length > 1) {\n      return this._block('service', ns, name, service);\n    }\n    else {\n      service = this._block('service', ns, name);\n      if (service && this._lib.isFunction(service.init)) {\n        return service.init();\n      }\n      else {\n        return service\n      }\n    }\n  }\n  /**\n   * 路由函数\n   *\n   * @private\n   * @method\n   * @name dispatch\n   * @memberof ndoo\n   */\n  dispatch() {\n    let {  _lib } = this;\n    let filterHaldner = (type: string, controller: any, actionName: string, params: string) => {\n      let data: any;\n      let { _lib } = this;\n      if (type === 'before') {\n        data = controller.before\n      }\n      else if (type === 'after') {\n        data = controller.after;\n      }\n      if (!data) {\n        return;\n      }\n      let _data: any[];\n      if (typeof data === 'object') {\n        _data = [].concat(data);\n      }\n      for (let dataItem of _data) {\n        let _filter = dataItem.filter;\n        if (!_lib.isArray(_filter)) {\n          _filter = [].concat(_filter.split(/\\s*,\\s*|\\s+/))\n        }\n        let isRun = true;\n        if (dataItem.only) {\n          let _only = dataItem.only;\n          if (!_lib.isArray(_only)) {\n            _only = [].concat(_only.split(/\\s*,\\s*|\\s+/))\n          }\n          if (_lib.indexOf(_only, actionName) < 0) {\n            isRun = false\n          }\n        }\n        else if (dataItem.except) {\n          let _except = dataItem.except;\n          if (!_lib.isArray(_except)) {\n            _except = [].concat(_except.split(/\\s*,\\s*|\\s+/))\n          }\n          if (_lib.indexOf(_except, actionName) > -1) {\n            isRun = false;\n          }\n        }\n        if (isRun) {\n          for (let filter of _filter) {\n            controller[`${filter}Filter`](actionName, params);\n          }\n        }\n      }\n    }\n    this.on(\n      'NAPP_ACTION_BEFORE',\n      (...data: any[]) => filterHaldner.apply(null, ['before'].concat(data))\n    );\n    this.on(\n      'NAPP_ACTION_AFTER',\n      (...data: any[]) => filterHaldner.apply(null, ['after'].concat(data))\n    );\n    this.on('NAPP_LOADED', (ns: string, appName: string, actionName: string, params) => {\n      let appData: any;\n      let _self = this;\n      if (ns) {\n        appData = this.app(`${ns}.${appName}`)\n      }\n      else {\n        appData = this.app(appName)\n      }\n\n      if (!_lib.has(appData, `${actionName}Action`) \n        && _lib.has(appData, 'emptyAction')) {\n          actionName = '_empty';\n      }\n\n      let depend = [];\n\n      if (appData['depend']) {\n        depend = depend.concat(appData['depend']);\n      }\n\n      if (appData[`${actionName}Depend`]) {\n        depend = depend.concat(appData[`${actionName}Depend`]);\n      }\n\n      let filterPrefix = appName;\n      if (ns) {\n        filterPrefix = (`${ns}.${appName}`).replace(/\\./g, '_')\n      }\n      filterPrefix = filterPrefix.toUpperCase();\n\n      let run = function() {\n        let args: any[] = [].slice.call(arguments, 0);\n        args.unshift(params);\n        if (actionName) {\n          _self.trigger('NAPP_ACTION_BEFORE', appData, actionName, params);\n          _self.trigger(`NAPP_${filterPrefix}_ACTION_BEFORE`, appData, actionName, params);\n\n          if (appData[`${actionName}Before`]) {\n            appData[`${actionName}Before`].apply(appData, args);\n          }\n          if (appData[`${actionName}Action`]) {\n            appData[`${actionName}Action`].apply(appData, args);\n          }\n          if (appData[`${actionName}After`]) {\n            appData[`${actionName}After`].apply(appData, args);\n          }\n\n          _self.trigger(`NAPP_${filterPrefix}_ACTION_AFTER`, appData, actionName, params);\n          _self.trigger('NAPP_ACTION_AFTER', appData, actionName, params);\n        }\n        _self.trigger('STATUS:NBLOCK_INIT');\n      }\n\n      if (depend.length) {\n        this.require(_lib.uniq(depend), run, this._loader['app']);\n      }\n      else {\n        run();\n      }\n    });\n    this.on('PAGE_STATUS_ROUTING', (data) => {\n      this.router.parse(\n        /^(?:\\/?)(.*?)(?:\\/?([^\\/?#]+))(?:\\?(.*?))?(?:\\#(.*?))?$/,\n        data, (appName: string, actionName: string, params: string) => {\n        let nsmatch = appName.match(/(.*?)(?:[/.]([^/.]+))$/);\n        let ns: string = '';\n        if (nsmatch) {\n          [, ns, appName] = nsmatch;\n        }\n        let pkg: string;\n        if (ns) {\n          ns = ns.replace(/\\//g, '.');\n          pkg = `${ns}.${appName}`;\n        }\n        else {\n          pkg = appName;\n        }\n\n        if (this.app(pkg)) {\n          this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n        }\n        else if (this.hasApp(pkg)) {\n          this.require([pkg], function() {\n            this.trigger('NAPP_LOADED', ns, appName, actionName, params);\n          }, this._loader['app']);\n        }\n        else {\n          this.trigger('STATUS:NBLOCK_INIT');\n        }\n      });\n    });\n  }\n  /**\n   * 触发页面状态\n   *\n   * @private\n   * @method\n   * @name triggerPageStatus\n   * @memberof ndoo\n   * @param depend {string|array} 赖数组\n   */\n  public triggerPageStatus(depend: string | string[]) {\n    let { _lib } = this;\n    let call = () => {\n      this.trigger('STATUS:PAGE_STATUS_FAST')\n\n      _lib.onready(() => {\n        this.trigger('STATUS:PAGE_STATUS_DOMPREP');\n        this.trigger('STATUS:PAGE_STATUS_DOM');\n        this.trigger('STATUS:PAGE_STATUS_DOMORLOAD');\n      });\n\n      _lib.onload(() => {\n        this.trigger('STATUS:PAGE_STATUS_LOAD');\n      });\n\n      this.on('PAGE_STATUS_DOM', () => {\n        if (this.pageId) {\n          this.trigger('STATUS:PAGE_STATUS_ROUTING', this.pageId);\n        }\n      });\n    }\n    depend ? this.require([].concat(depend), call, this._loader['init']) : call();\n  }\n  /**\n   * 初始化页面\n   *\n   * @method\n   * @name init\n   * @memberof ndoo\n   * @param {string} id DOM的ID或指定ID\n   * @param {array} depend 依赖\n   * @example // ndoo alias _n\n   * _n.init('home/index')\n   * // set depend\n   * _n.init('home/index', ['library', 'common'])\n   */\n  init(id?: string | string[], depend?: string| string[]) {\n    let { _lib } = this;\n    if (_lib.isArray(id)) {\n      [id, depend] = ['', id];\n    }\n\n    this.initPageId(<string>id);\n    this.dispatch();\n    this.triggerPageStatus(depend);\n    return this;\n  }\n  private _rebuildEvent() {\n    let { _lib } = this;\n    let eventHandle = _lib.extend({\n      events: {},\n      listened: {}\n    }, _lib.Events);\n    this.event = _lib.extend(this.event, {\n      eventHandle,\n      on: function(eventName: string, callback: Function) {\n        let { eventHandle } = this;\n        eventHandle.on(eventName, callback);\n        eventHandle.listened[eventName] = true;\n        if (_lib.has(eventHandle.events, `STATUS:${eventName}`)) {\n          callback.apply(eventHandle, eventHandle.events[`STATUS:${eventName}`]);\n        }\n        if (_lib.has(eventHandle.events, eventName)) {\n          for (let item of eventHandle.events[eventName]) {\n            callback.apply(eventHandle, item);\n          }\n        }\n      },\n      trigger: function(eventName: string, eventType: string, data: any[]) {\n        let { eventHandle } = this;\n        if (eventType === 'DEFAULT') {\n          eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n        }\n        else if (eventType === 'DELAY') {\n          if (_lib.has(eventHandle.listened, eventName)) {\n            eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n          }\n          if (!_lib.has(eventHandle.events, eventName)) {\n            eventHandle.events[eventName] = []\n          }\n          eventHandle.events[eventName].push(data);\n        }\n        else if (eventType === 'STATUS') {\n          if (!_lib.has(eventHandle.events, `${eventType}:${eventName}`)) {\n            eventHandle.events[`${eventType}:${eventName}`] = data;\n            if (_lib.has(eventHandle.listened, eventName)) {\n              eventHandle.trigger.apply(eventHandle, [eventName].concat(data));\n            }\n          }\n        } \n      },\n      off: function(eventName: string) {\n        let { eventHandle } = this;\n        eventHandle.off(eventName);\n        delete eventHandle.listened[eventName];\n        delete eventHandle.events[eventName];\n      },\n      init: function() {\n        let { inited, _temp, TYPE_ON, TYPE_TRIGGER } = this;\n        if (!inited && _temp.length) {\n          for (let item of _temp) {\n            if (item.type === TYPE_ON) {\n              this.on(item.eventName, item.callback);\n            }\n            else if (item.type === TYPE_TRIGGER) {\n              this.trigger(item.eventName, item.eventTYpe, item.data);\n            }\n          }\n          inited = true;\n        }\n      }\n    });\n  }\n  public RegType: any = RegType;\n  public Component: any = getComponent(this);\n  constructor() {\n    super();\n    this.storage._lib = this._lib;\n\n    this._rebuildEvent();\n    this.event.init();\n\n    this.trigger('STATUS:NAPP_DEFINE');\n    this.trigger('STATUS:NBLOCK_DEFINE');\n    this.trigger('STATUS:NSERVICE_DEFINE');\n    this._bindBlockEvent();\n\n    if (prepData) {\n      removePrepData();\n    }\n\n    // this.RegType = RegType;\n    // this.Component = getComponent(this);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/ndoo.ts","import { EventApi } from './event/api';\nimport { EventBasic } from './event/basic';\nimport { getPrepData, PrepDataType } from './prepData';\nlet prepData = getPrepData();\n\n/**\n * ndoojs 全局名称空间，短名称N\n *\n * @namespace ndoo\n */\nclass Prep extends EventApi {\n  public event: typeof EventBasic = EventBasic;\n\n  /**\n   * 变量存储名称空间\n   *\n   * @namespace\n   * @name vars\n   * @alias _vars\n   * @memberof ndoo\n   * @type {object}\n   * @example // alias _vars\n   * var _vars = ndoo.vars;\n   * vars.bar = 'bar';\n   */\n  public vars: any = {};\n\n  /**\n   * 函数存储名称空间\n   *\n   * @namespace\n   * @name func\n   * @memberof ndoo\n   * @type {object}\n   * @example // alias _func\n   * var _func = ndoo.func;\n   * _func.foo = function() {\n   *   console.log('foo');\n   * }\n   */\n  public func: any = {};\n\n  /**\n   * 依赖库存储空间\n   */\n  public _lib: any = {};\n\n  constructor() {\n    super();\n    if (prepData) {\n      this.vars = (prepData as PrepDataType).vars;\n      this.func = (prepData as PrepDataType).func;\n    }\n  }\n}\n\nexport { Prep }\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/prep.ts","import { EventBasic } from './basic';\nexport class EventApi {\n  public event: typeof EventBasic;\n\n  /**\n   * global on\n   *\n   * @method\n   * @name on\n   * @memberof ndoo\n   * @param {string} eventName 事件名称\n   * @param {function} callback 事件回调\n   * @example // ndoo alias _n\n   * var _n = ndoo;\n   * _n.on('testEvent', function(data, data2){\n   *   console.log(data);\n   *   console.log(data2);\n   * });\n   * _n.trigger('testEvent', 'testEvent', 'kkk');\n   */\n  public on(eventName: string | string[], callback: Function) {\n    eventName = (<string>eventName).split(/\\s*,\\s*|\\s+/);\n    for (let e of <string[]>eventName) {\n        this.event.on(e, callback);\n    }\n  }\n\n  /**\n   * global trigger\n   *\n   * @method\n   * @name trigger\n   * @memberof ndoo\n   * @param {string} eventName 事件名称\n   * @param {variable} data 数据，可以是多个\n   */\n  public trigger(eventName: string | string[], ...data: any[]) {\n    let _index = eventName.indexOf(':');\n    let type = (<string>eventName).substring(0, _index++) || 'DEFAULT';\n    let e = (<string>eventName).substring(_index);\n\n    this.event.trigger(e, type, data);\n  }\n\n  /**\n   * global off\n   *\n   * @method\n   * @name off\n   * @memberof ndoo\n   * @param {string} eventName 事件名称\n   */\n  public off(eventName: string | string[]) {\n    eventName = (<string>eventName).split(/\\s*,\\s*|\\s+/);\n    for(let e of <string[]>eventName) {\n        this.event.off(e);\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/event/api.ts","import { getPrepData, PrepDataType } from '../prepData';\nlet prepData = getPrepData();\n\n/**\n * 事件模块\n *\n * @namespace\n * @name event\n * @memberof ndoo\n * @param {string} name 事件名称\n * @param {string} type 事件类型\n */\nexport class EventBasic {\n  constructor(name: string, type: string) {\n    return `#${name}:#${type}`;\n  }\n\n  /**\n   * 暂存数据类型\n   *\n   * @name TYPE_ON\n   * @memberof ndoo.event\n   * @type {number}\n   */\n  static TYPE_ON:number = 1;\n\n  /**\n   * 暂存数据类型\n   *\n   * @name TYPE_TRIGGER\n   * @memberof ndoo.event\n   * @type {number}\n   */\n  static TYPE_TRIGGER:number = 2;\n\n  /**\n   * init token\n   *\n   * @name inited\n   * @memberof ndoo.event\n   * @type {boolean}\n   */\n  static inited:boolean = false;\n\n  /**\n   * event stack\n   *\n   * @private\n   * @name _temp\n   * @memberof ndoo.event\n   * @type {array}\n   */\n  static _temp:Array<any> = prepData ? (prepData as PrepDataType).eventData : [];\n\n  /**\n   * on api\n   *\n   * @method\n   * @name on\n   * @memberof ndoo.event\n   * @param {string} eventName 事件名称\n   * @param {function} callback 回调函数\n   */\n  static on(eventName: string, callback: Function) {\n    this._temp.push({\n      type: this.TYPE_ON,\n      eventName, callback\n    })\n  }\n\n  /**\n   * trigger api\n   *\n   * @method\n   * @name trigger\n   * @memberof ndoo.event\n   * @param eventName {string} 事件名称\n   * @param eventType {string} 事件类型\n   * @param data {variable} 数据类型\n   */\n  static trigger(eventName: string, eventType: string, data: Array<any>) {\n    this._temp.push({\n      type: this.TYPE_TRIGGER,\n      eventName, eventType, data\n    });\n  }\n\n  /**\n   * off api\n   *\n   * @method\n   * @name off\n   * @memberof ndoo.event\n   * @param eventName {string}\n   */\n  static off(eventName: string) { }\n  static init() {}\n}\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/event/basic.ts","export interface PrepDataType {\n  eventData: any[],\n  func: any,\n  vars: any\n}\n\nexport let getPrepData = function (): PrepDataType | boolean {\n  if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n    return window['ndoo_prep_data'];\n  }\n  return false;\n}\n\nexport let setPrepData = function () {\n  let _self: any = {};\n  if (typeof window != 'undefined') {\n    _self = window;\n  }\n  if (!_self.ndoo_prep_data) {\n    _self.ndoo_prep_data = {\n      eventData: [],\n      func: {},\n      vars: {}\n    };\n  }\n}\n\nexport let removePrepData = function () {\n  if (typeof window != 'undefined' && window['ndoo_prep_data']) {\n    delete window['ndoo_prep_data'];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/prepData.ts","/**\n * 变量存储\n *\n * @method\n * @name storage\n * @memberof ndoo\n * @param {string} key 键名\n * @param {variable} value 值\n * @param {const} option 选项，覆盖或删除\n * @example // alias _stor\n * var _stor = ndoo.storage;\n * // set abc vlaue 1\n * _stor('abc', 1); // 1\n * // set abc value 2 failed\n * _stor('abc', 2); // false\n * // set abc value 2\n * _stor('abc', 2, _stor.REWRITE); // 2\n * // delete abc\n * _stor('abc', null, _stor.DESTROY); // true\n */\nexport class Storage {\n  static _data: any = {};\n  /**\n   * storage重写常量\n   *\n   * @memberof ndoo.storage\n   */\n  static REWRITE: number = 1;\n\n  /**\n   * storage删除常量\n   *\n   * @memberof ndoo.storage\n   */\n  static DESTROY: number = 2;\n  static _lib: {\n      has(data: any, key: string): boolean;\n  };\n\n  constructor(key, value, option: number) {\n    let _self = Storage;\n    let destroy = option & _self.DESTROY;\n    let rewrite = option & _self.REWRITE;\n    let data = _self._data;\n\n    if (value === undefined) {\n      return data[key];\n    }\n\n    if (destroy) {\n      delete data[key];\n      return true;\n    }\n\n    if (!rewrite && _self._lib.has(data, key)) {\n      return false;\n    }\n\n    return data[key] = value;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/storage.ts","/**\n * 内置路由通过正则配匹各部件\n *\n * @private\n * @namespace\n * @memberof ndoo\n * @type {object}\n */\nexport class Router {\n  /**\n   * 路由解析方法\n   * \n   * @private\n   * @method\n   * @memberof ndoo.router\n   * @param route {RegExp} 路由正则\n   * @param url {string url路径\n   * @param callback {Function} 回调函数\n   */\n  static parse(route: RegExp, url: string, callback: Function) {\n    let routeMatch = route.exec(url);\n    if (routeMatch != null) {\n      callback.apply(null, routeMatch.slice(1));\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/router.ts","import * as _ from 'underscore';\nimport * as depend from './depend'\nimport { Events } from './event';\nexport let _lib = _.extend({ Events }, depend, _);\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/lib/index.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 10\n// module chunks = 0","/// <references src=\"../declare.d.ts\" />\nimport * as jquery from 'jquery';\nimport * as zepto from 'zepto';\n\nlet $ = jquery || zepto;\nlet depend: any = {};\nif ($) {\n  depend.onready = function (callback: EventListener) {\n    return $(callback);\n  }\n  depend.onload = function (callback: EventListener) {\n    return $(window).on('load', callback);\n  }\n  depend.querySelector = function (selector: any) {\n    return $(selector).get();\n  }\n  depend.data = function (elem: HTMLElement, key: string, value: any) {\n    if (arguments.length === 2) {\n      return $(elem).data(key);\n    }\n    else if (arguments.length === 3) {\n      return $(elem).data(key, value);\n    }\n  }\n}\nelse {\n  depend.onready = function (callback: EventListener) {\n    return document.addEventListener('DOMContentLoaded', callback, false);\n  }\n  depend.onload = function (callback: EventListener) {\n    return addEventListener('load', callback, false);\n  }\n  depend.querySelector = function (selector: any) {\n    return document.querySelectorAll(selector);\n  }\n  depend.data = function (elem: HTMLElement, key: string, value?: any) {\n    if (!elem.dataset) {\n      key = key.replace(/([A-Z])/g, (char) => '-' + char.toLocaleLowerCase());\n    }\n    if (arguments.length === 2) {\n      if (elem.dataset) {\n        return elem.dataset[key];\n      }\n      else {\n        return elem.getAttribute(key);\n      }\n    }\n    else if (arguments.length === 3) {\n      if (elem.dataset) {\n        elem.dataset[key] = value;\n      }\n      else {\n        elem.setAttribute(key, value);\n      }\n    }\n  }\n}\n\nexport let { onready, onload, querySelector, data } = depend;\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/lib/depend.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 12\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_13__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Zepto\"\n// module id = 13\n// module chunks = 0","import * as _ from 'underscore';\nimport * as Backbone from 'backbone';\n\nlet Events: any = {};\n\nif (Backbone) {\n  Events = Backbone.Events;\n}\nelse {\n// Backbone.Events\n// ---------------\n\n// A module that can be mixed in to *any object* in order to provide it with\n// a custom event channel. You may bind a callback to an event with 'on' or\n// remove with 'off'; 'trigger'-ing an event fires all callbacks in\n// succession.\n//\n//     var object = {};\n//     _.extend(object, Backbone.Events);\n//     object.on('expand', function(){ alert('expanded'); });\n//     object.trigger('expand');\n//\n// var Events: any = {};\n\n// Regular expression used to split event strings.\nvar eventSplitter = /\\s+/;\n\n// Iterates over the standard 'event, callback' (as well as the fancy multiple\n// space-separated events '\"change blur\", callback' and jQuery-style event\n// maps '{event: callback}').\nvar eventsApi = function (iteratee, events, name, callback, opts) {\n  var i = 0, names;\n  if (name && typeof name === 'object') {\n    // Handle event maps.\n    if (callback !== void 0 && 'context' in opts && opts.context === void 0) opts.context = callback;\n    for (names = _.keys(name); i < names.length; i++) {\n      events = eventsApi(iteratee, events, names[i], name[names[i]], opts);\n    }\n  } else if (name && eventSplitter.test(name)) {\n    // Handle space separated event names by delegating them individually.\n    for (names = name.split(eventSplitter); i < names.length; i++) {\n      events = iteratee(events, names[i], callback, opts);\n    }\n  } else {\n    // Finally, standard events.\n    events = iteratee(events, name, callback, opts);\n  }\n  return events;\n};\n\n// Bind an event to a 'callback' function. Passing '\"all\"' will bind\n// the callback to all events fired.\nEvents.on = function (name, callback, context) {\n  return internalOn(this, name, callback, context);\n};\n\n// Guard the 'listening' argument from the public API.\nvar internalOn = function (obj: any, name: any, callback: any, context: any, listening?: any) {\n  obj._events = eventsApi(onApi, obj._events || {}, name, callback, {\n    context: context,\n    ctx: obj,\n    listening: listening\n  });\n\n  if (listening) {\n    var listeners = obj._listeners || (obj._listeners = {});\n    listeners[listening.id] = listening;\n  }\n\n  return obj;\n};\n\n// Inversion-of-control versions of 'on'. Tell *this* object to listen to\n// an event in another object... keeping track of what it's listening to\n// for easier unbinding later.\nEvents.listenTo = function (obj, name, callback) {\n  if (!obj) return this;\n  var id = obj._listenId || (obj._listenId = _.uniqueId('l'));\n  var listeningTo = this._listeningTo || (this._listeningTo = {});\n  var listening = listeningTo[id];\n\n  // This object is not listening to any other events on 'obj' yet.\n  // Setup the necessary references to track the listening callbacks.\n  if (!listening) {\n    var thisId = this._listenId || (this._listenId = _.uniqueId('l'));\n    listening = listeningTo[id] = { obj: obj, objId: id, id: thisId, listeningTo: listeningTo, count: 0 };\n  }\n\n  // Bind callbacks on obj, and keep track of them on listening.\n  internalOn(obj, name, callback, this, listening);\n  return this;\n};\n\n// The reducing API that adds a callback to the 'events' object.\nvar onApi = function (events, name, callback, options) {\n  if (callback) {\n    var handlers = events[name] || (events[name] = []);\n    var context = options.context, ctx = options.ctx, listening = options.listening;\n    if (listening) listening.count++;\n\n    handlers.push({ callback: callback, context: context, ctx: context || ctx, listening: listening });\n  }\n  return events;\n};\n\n// Remove one or many callbacks. If 'context' is null, removes all\n// callbacks with that function. If 'callback' is null, removes all\n// callbacks for the event. If 'name' is null, removes all bound\n// callbacks for all events.\nEvents.off = function (name, callback, context) {\n  if (!this._events) return this;\n  this._events = eventsApi(offApi, this._events, name, callback, {\n    context: context,\n    listeners: this._listeners\n  });\n  return this;\n};\n\n// Tell this object to stop listening to either specific events ... or\n// to every object it's currently listening to.\nEvents.stopListening = function (obj, name, callback) {\n  var listeningTo = this._listeningTo;\n  if (!listeningTo) return this;\n\n  var ids = obj ? [obj._listenId] : _.keys(listeningTo);\n\n  for (var i = 0; i < ids.length; i++) {\n    var listening = listeningTo[ids[i]];\n\n    // If listening doesn't exist, this object is not currently\n    // listening to obj. Break out early.\n    if (!listening) break;\n\n    listening.obj.off(name, callback, this);\n  }\n  if (_.isEmpty(listeningTo)) this._listeningTo = void 0;\n\n  return this;\n};\n\n// The reducing API that removes a callback from the 'events' object.\nvar offApi = function (events, name, callback, options) {\n  if (!events) return;\n\n  var i = 0, listening;\n  var context = options.context, listeners = options.listeners;\n\n  // Delete all events listeners and \"drop\" events.\n  if (!name && !callback && !context) {\n    var ids = _.keys(listeners);\n    for (; i < ids.length; i++) {\n      listening = listeners[ids[i]];\n      delete listeners[listening.id];\n      delete listening.listeningTo[listening.objId];\n    }\n    return;\n  }\n\n  var names = name ? [name] : _.keys(events);\n  for (; i < names.length; i++) {\n    name = names[i];\n    var handlers = events[name];\n\n    // Bail out if there are no events stored.\n    if (!handlers) break;\n\n    // Replace events if there are any remaining.  Otherwise, clean up.\n    var remaining = [];\n    for (var j = 0; j < handlers.length; j++) {\n      var handler = handlers[j];\n      if (\n        callback && callback !== handler.callback &&\n        callback !== handler.callback._callback ||\n        context && context !== handler.context\n      ) {\n        remaining.push(handler);\n      } else {\n        listening = handler.listening;\n        if (listening && --listening.count === 0) {\n          delete listeners[listening.id];\n          delete listening.listeningTo[listening.objId];\n        }\n      }\n    }\n\n    // Update tail event if the list has any events.  Otherwise, clean up.\n    if (remaining.length) {\n      events[name] = remaining;\n    } else {\n      delete events[name];\n    }\n  }\n  if (_.size(events)) return events;\n};\n\n// Bind an event to only be triggered a single time. After the first time\n// the callback is invoked, its listener will be removed. If multiple events\n// are passed in using the space-separated syntax, the handler will fire\n// once for each event, not once for a combination of all events.\nEvents.once = function (name, callback, context) {\n  // Map the event into a '{event: once}' object.\n  var events = eventsApi(onceMap, {}, name, callback, _.bind(this.off, this));\n  return this.on(events, void 0, context);\n};\n\n// Inversion-of-control versions of 'once'.\nEvents.listenToOnce = function (obj, name, callback) {\n  // Map the event into a '{event: once}' object.\n  var events = eventsApi(onceMap, {}, name, callback, _.bind(this.stopListening, this, obj));\n  return this.listenTo(obj, events);\n};\n\n// Reduces the event callbacks into a map of '{event: onceWrapper}'.\n// 'offer' unbinds the 'onceWrapper' after it has been called.\nvar onceMap = function (map, name, callback, offer) {\n  if (callback) {\n    var once = map[name] = _.once(function () {\n      offer(name, once);\n      callback.apply(this, arguments);\n    });\n    once._callback = callback;\n  }\n  return map;\n};\n\n// Trigger one or many events, firing all bound callbacks. Callbacks are\n// passed the same arguments as 'trigger' is, apart from the event name\n// (unless you're listening on '\"all\"', which will cause your callback to\n// receive the true name of the event as the first argument).\nEvents.trigger = function (name) {\n  if (!this._events) return this;\n\n  var length = Math.max(0, arguments.length - 1);\n  var args = Array(length);\n  for (var i = 0; i < length; i++) args[i] = arguments[i + 1];\n\n  eventsApi(triggerApi, this._events, name, void 0, args);\n  return this;\n};\n\n// Handles triggering the appropriate event callbacks.\nvar triggerApi = function (objEvents, name, cb, args) {\n  if (objEvents) {\n    var events = objEvents[name];\n    var allEvents = objEvents.all;\n    if (events && allEvents) allEvents = allEvents.slice();\n    if (events) triggerEvents(events, args);\n    if (allEvents) triggerEvents(allEvents, [name].concat(args));\n  }\n  return objEvents;\n};\n\n// A difficult-to-believe, but optimized internal dispatch function for\n// triggering events. Tries to keep the usual cases speedy (most internal\n// Backbone events have 3 arguments).\nvar triggerEvents = function (events, args) {\n  var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n  switch (args.length) {\n    case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;\n    case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;\n    case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;\n    case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;\n    default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args); return;\n  }\n};\n\n// Aliases for backwards compatibility.\nEvents.bind = Events.on;\nEvents.unbind = Events.off;\n}\n\nexport { Events };\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/lib/event.ts","module.exports = __WEBPACK_EXTERNAL_MODULE_15__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Backbone\"\n// module id = 15\n// module chunks = 0","export enum RegType {\n  App,\n  Block,\n  Service\n}\n\nexport let getComponent = (ndoo: any) => {\n  /**\n   * ndoo组件注册\n   */\n  return (path: string, type: RegType, isStatic = true) => (component: any) => {\n    // 是否静态类型\n    let instance = component;\n    if (!isStatic) {\n      instance = new component();\n    }\n    // 注册类型\n    let method = '';\n    switch (type) {\n      case RegType.App:\n        method = 'app';\n        break;\n      case RegType.Block:\n        method = 'block';\n        break;\n      case RegType.Service:\n        method = 'service';\n        break;\n    }\n    // 注册\n    method && ndoo[method](path, instance);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./_source/ts/src/component.ts"],"sourceRoot":""}